{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/util/helpers.js","webpack:///./src/general/transforms.js","webpack:///./src/data-sources/condo-list.js","webpack:///./src/data-sources/crime-incidents.js","webpack:///./src/data-sources/dor-documents.js","webpack:///./src/data-sources/li-business-licenses.js","webpack:///./src/data-sources/regmaps.js","webpack:///./src/data-sources/sanitation-centers.js","webpack:///./src/topics/property.js","webpack:///./src/topics/condos.js","webpack:///./src/topics/deeds.js","webpack:///./src/topics/li.js","webpack:///./src/topics/zoning.js","webpack:///./src/topics/311.js","webpack:///./src/topics/stormwater.js","webpack:///./src/topics/nearby.js","webpack:///./src/topics/districts.js","webpack:///./src/main.js","webpack:///./node_modules/moment/locale sync en","webpack:///./public/styles.css","webpack:///./public/styles.css?7705","webpack:///./src/general/map.js","webpack:///./src/general/parcels.js","webpack:///./src/general/imageOverlayGroups.js","webpack:///./src/general/legendControls.js","webpack:///./src/general/greeting.js","webpack:///./src/data-sources/311-carto.js","webpack:///./src/data-sources/assessment-history.js","webpack:///./public/index.html","webpack:///./src/data-sources/dor-condo-list.js","webpack:///./src/data-sources/li-inspections.js","webpack:///./src/data-sources/li-permits.js","webpack:///./src/data-sources/li-permits-additional.js","webpack:///./src/data-sources/li-violations.js","webpack:///./src/data-sources/nearby-zoning-appeals.js","webpack:///./src/data-sources/opa.js","webpack:///./src/data-sources/rco.js","webpack:///./src/data-sources/street-closures.js","webpack:///./src/data-sources/stormwater.js","webpack:///./src/data-sources/vacant-building.js","webpack:///./src/data-sources/vacant-indicator-points.js","webpack:///./src/data-sources/vacant-land.js","webpack:///./src/data-sources/zoning-appeals.js","webpack:///./src/data-sources/zoning-base.js","webpack:///./src/data-sources/zoning-overlay.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","2","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","p","jsonpArray","window","oldJsonpFunction","bind","slice","helpers","GATEKEEPER_KEY","ZONING_CODE_MAP","RSD-1","RSD-2","RSD-3","RSA-1","RSA-2","RSA-3","RSA-4","RSA-5","RTA-1","RM-1","RM-2","RM-3","RM-4","RMX-1","RMX-2","RMX-3","CA-1","CA-2","CMX-1","CMX-2","CMX-2.5","CMX-3","CMX-4","CMX-5","I-1","I-2","I-3","IP","ICMX","IRMX","SPENT","SPAIR","SPINS","SPSTA","SPPOA","SP-PO-A","SPPOP","cleanDorAttribute","attr","cleanAttr","String","replace","indexOf","concatDorAddress","parcel","includeUnit","props","properties","addressLow","this","HOUSE","addressHigh","STEX","addressSuffix","SUF","address","unit","UNIT","comps","map","streetField","concat","filter","Boolean","join","getVacancyText","state","land","sources","vacantLand","building","vacantBuilding","accounting","settings","currency","precision","transforms","bold","transform","booleanToYesNo","thousandsPlace","match","globals","formatMoney","date","moment","format","dayofweek","feet","getNearest","field","distName","min","Math","item","integer","isNaN","parseInt","nowrap","nth","phoneNumber","prettyNumber","toLocaleString","rcoPrimaryContact","exec","std","orig","squareFeet","titleCase","str","toLowerCase","split","word","charAt","toUpperCase","urlFormatter","txt","expStr","RegExp","condo_list","success","type","url","options","feature","street_address","gatekeeperKey","include_units","table","dateMinType","dateField","dor_documents","where","targets","parcels","dor","getTargetId","parcelBaseAddress","target","OBJECTID","street_predir","geocode","address_low_frac","address_low","floor","addressFloor","unitNum","address_low_suffix","unitNum2","street_postdir","unit_num","outFields","BASEREG","params","f","features","regmaps","parts","coordPairs","targetGeometry","Leaflet","yVals","coordPair","innerCoordPair","forEach","Array","isArray","xVals","max","coordsAreDefined","xMin","coord","x","bounds","latLngBounds","yMax","xMax","yMin","every","label","key","icon","components","text","slots","fields","ownersJoined","opa_owners","property_titleCase","zip_code","opa","mailing_care_of","mailing","mailing_address_1","mailing_address_2","console","log","mailing_street","mailing_city_state","mailing_zip","location","id","action","href","exempt_land","opa_account_num","exempt_building","homestead_exemption","getValue","building_code_description","exterior","exterior_condition","items","itemRow","beginning_point","total_area","basemap","identifyFeature","sale_price","sale_date","message","year","market_value","taxable_land","undefined","pathToDataArray","minDataLength","showTopicOnlyIfDataExists","sort","order","topicKey","useApiCount","defaultIncrement","rows","row","title","errorMessage","condoList","numCondos","total_size","shouldPluralize","otherData","requiredData","plural","getKey","highestPageRetrieved","page","pageCount","page_count","totalSize","deeds","desc","singular","list","MAPREG","getAddress","nullValue","STATUS","ORIG_DATE","INACTDATE","showAllRowsOnFirstClick","SUFFIX","CONDOFLAG","condounit","condo_name","dorCondoList","imageOverlayGroup","attributes","DOCUMENT_ID","DISPLAY_DATE","DOCUMENT_TYPE","GRANTORS","GRANTEES","DISCREPANCY","dorDocuments","li","dataSources","subtitle","limit","permitissuedate","permitnumber","addresskey","permitdescription","inspectiondescription","inspectionstatus","externalLink","count","encodeURIComponent","scan_date","permit_number","num_pages","appId","app_id","doc_id","addressEncoded","inspectioncompleted","casenumber","caseaddeddate","violationdescription","status","PERMITISSUEDATE","dynamicMapLayers","initialissuedate","licensenum","business_name","licensetype","titleBackground","shouldShowFilters","PERMITNUMBER","ADDRESSKEY","ADDRESS","BLDGAREA","DECLAREDVALUE","longCodesUnique","zoning","getTitle","rowsFiltered","overlayRowsFilteredWithType","shouldShowHeaders","overlayRowsFiltered","zoningAndOverlays","rowsFilteredWithType","_target$data","zoningBase","_data$rows","longCodes","long_code","longCodesUniqueSet","Set","from","date_scheduled","code_section_link","code_section","zoningOverlay","billType","currentZoning","pendingbillurl","pendingbill","_data$rows2","MEETING_LOCATION_ADDRESS","pending","PRIMARY_EMAIL","PREFFERED_CONTACT_METHOD","overlay_name","appeal_key","appealno","sortFields","decision","val","REQUESTED_DATETIME","sortField","values","ORGANIZATION_NAME","ORGANIZATION_ADDRESS","direction","PRIMARY_NAME","PRIMARY_PHONE","filterByText","mapOverlay","radius","fillColor","color","weight","fillOpacity","topics_311","SUBJECT","obj","writable","_defineProperty","select","_distance","stormwater","marker","style","hoverStyle","opacity","MeterSize","StormwaterStatus","MEDIA_URL","DESCRIPTION","nearby","distance","dispatch_date","requested_datetime","media_url","service_name","filters","location_block","text_general_code","VACANT_FLAG","decisiondate","appealgrounds","forceShow","add","faHome","faBook","faWrench","faUniversity","faGavel","faMapMarkerAlt","faLandmark","faBuilding","faPhone","faTint","faClone","main_location$hostname","hostname","main_hostname","info","debug","error","accounting_default","a","mapboard_default","panels","router","enabled","defaultAddressTextPlaceholder","max-width","font-size","geolocation","rootStyle","bottom","right","defaultBasemap","defaultIdentifyFeature","imagery","initialImagery","pwd","multipleAllowed","geocodeFailAttemptParcel","clearStateOnError","wipeOutOtherParcelsOnReverseGeocodeOnly","geocodeField","parcelIdInGeocoder","getByLatLngIfIdFails","legendControls","topics","showWithBaseMapOnly","Roof","background-color","Other Impervious Surface","Easements","border-color","border-style","border-weight","width","height","Trans Parcels","Rights of Way","cyclomedia","measurementAllowed","dateMinNum","q","distances","assessmentHist","urlAddition","eclipse_location_id","li_address_key","toString","parcel_number","relationship","returnGeometry","seg_id","returnDistinctValues","search","geometryServerUrl","calculateDistance","stmt","dependent","addressKey","mapreg","Parcel","ParcelID","BldgType","GrossArea","ImpervArea","CAPEligible","AccountNumber","CustomerName","AcctStatus","tables","ServiceTypeLabel","Accounts","library","planning_district","li_district","census_block_group_2010","commercial_corridor","police_district","police_service_area","political_division","BASE_CONFIG_URL","highway_subsection","street_light_route","traffic_district","traffic_pm_district","mapWidth","position","autocompleteEnabled","autocompleteMax","left"],"mappings":"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","file":"app.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \tvar installedChunks = {\n \t\t2: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([379,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export default {\r\n  GATEKEEPER_KEY: '6c5f564b450f91deca224249a6a36033',\r\n  ZONING_CODE_MAP: {\r\n    'RSD-1': 'Residential Single Family Detached-1',\r\n    'RSD-2': 'Residential Single Family Detached-2',\r\n    'RSD-3': 'Residential Single Family Detached-3',\r\n    'RSA-1': 'Residential Single Family Attached-1',\r\n    'RSA-2': 'Residential Single Family Attached-2',\r\n    'RSA-3': 'Residential Single Family Attached-3',\r\n    'RSA-4': 'Residential Single Family Attached-4',\r\n    'RSA-5': 'Residential Single Family Attached-5',\r\n    'RTA-1': 'Residential Two-Family Attached-1',\r\n    'RM-1': 'Residential Multi-Family-1',\r\n    'RM-2': 'Residential Multi-Family-2',\r\n    'RM-3': 'Residential Multi-Family-3',\r\n    'RM-4': 'Residential Multi-Family-4',\r\n    'RMX-1': 'Residential Mixed-Use-1',\r\n    'RMX-2': 'Residential Mixed-Use-2',\r\n    'RMX-3': 'Residential (Center City) Mixed-Use-3',\r\n    'CA-1': 'Auto-Oriented Commercial-1',\r\n    'CA-2': 'Auto-Oriented Commercial-2',\r\n    'CMX-1': 'Neighborhood Commercial Mixed-Use-1',\r\n    'CMX-2': 'Neighborhood Commercial Mixed-Use-2',\r\n    'CMX-2.5': 'Neighborhood Commercial Mixed-Use-2.5',\r\n    'CMX-3': 'Community Commercial Mixed-Use',\r\n    'CMX-4': 'Center City Commercial Mixed-Use',\r\n    'CMX-5': 'Center City Core Commercial Mixed-Use',\r\n    'I-1': 'Light Industrial',\r\n    'I-2': 'Medium Industrial',\r\n    'I-3': 'Heavy Industrial',\r\n    'IP': 'Port Industrial',\r\n    'ICMX': 'Industrial Commercial Mixed-Use',\r\n    'IRMX': 'Industrial Residential Mixed-Use',\r\n    'SPENT': 'Commercial Entertainment (Casinos)',\r\n    'SPAIR': 'Airport',\r\n    'SPINS': 'Institutional Development',\r\n    'SPSTA': 'Stadium',\r\n    'SPPOA': 'Recreation',\r\n    'SP-PO-A': 'Recreation',\r\n    'SPPOP': 'Recreation',\r\n  },\r\n\r\n  cleanDorAttribute(attr) {\r\n    // console.log('cleanDorAttribute is running with attr', attr);\r\n    // trim leading and trailing whitespace\r\n    var cleanAttr = attr ? String(attr) : '';\r\n    cleanAttr = cleanAttr.replace(/\\s+/g, '');\r\n\r\n    // return null for zeros and empty strings\r\n    // if (['', '0'].indexOf(cleanAttr) > -1) {\r\n    //   return null;\r\n    // }\r\n\r\n    // return empty for zeros and null\r\n    if ([null, '0'].indexOf(cleanAttr) > -1) {\r\n      return '';\r\n    }\r\n\r\n    // console.log('cleanDorAttribute cleanAttr result:', cleanAttr);\r\n    return cleanAttr;\r\n  },\r\n\r\n  // TODO put this in base config transforms\r\n  concatDorAddress(parcel, includeUnit) {\r\n    includeUnit = !!includeUnit;\r\n    var STREET_FIELDS = ['STDIR', 'STNAM', 'STDES', 'STDESSUF'];\r\n    var props = parcel.properties;\r\n\r\n    // handle house num\r\n    var addressLow = this.cleanDorAttribute(props.HOUSE);\r\n    var addressHigh = this.cleanDorAttribute(props.STEX);\r\n    // maybe should be props.SUF below (it said props.SUFFIX)\r\n    var addressSuffix = this.cleanDorAttribute(props.SUF);\r\n    var address = addressLow;\r\n    address = address + (addressHigh ? '-' + addressHigh : '');\r\n    address = address + (addressSuffix || '');\r\n\r\n    // handle unit\r\n    var unit = this.cleanDorAttribute(props.UNIT);\r\n    if (unit) unit = '# ' + unit;\r\n\r\n    // clean up attributes\r\n    var comps = STREET_FIELDS.map(function(streetField) {\r\n      return props[streetField];\r\n    });\r\n    comps = comps.map(this.cleanDorAttribute);\r\n        // TODO handle individual address comps (like mapping stex=2 => 1/2)\r\n        // addressLow = comps.HOUSE,\r\n        // addressHigh = comps.STEX,\r\n        // streetPredir = comps.STDIR,\r\n        // streetName = comps.STNAM,\r\n        // streetSuffix = comps.STDES,\r\n        // streetPostdir = comps.STDESSUF,\r\n\r\n    // add address to front\r\n    comps = [address].concat(comps);\r\n\r\n    // add unit to end\r\n    if (includeUnit) comps = comps.concat([unit]);\r\n\r\n    // remove nulls and concat\r\n    address = comps.filter(Boolean).join(' ');\r\n\r\n    // console.log('concatDorAddress address result:', address);\r\n    if (address === '') {\r\n      address = 'Parcel has no address';\r\n    }\r\n    return address;\r\n  },\r\n\r\n  getVacancyText(state) {\r\n    var land = state.sources.vacantLand.data\r\n    var building = state.sources.vacantBuilding.data\r\n    if (land.length === 0 && building.length === 0) {\r\n      return 'Not Likely Vacant'\r\n    } else if (land.length > 0) {\r\n      return 'Likely Vacant Land'\r\n    } else if (building.length > 0) {\r\n      return 'Likely Vacant Building'\r\n    }\r\n  }\r\n}\r\n","import accounting from 'accounting';\r\nimport moment from 'moment';\r\n\r\naccounting.settings.currency.precision = 0;\r\n\r\nexport default {\r\n  bold: {\r\n    transform: function (value) {\r\n      return '<strong>' + value + '</strong>';\r\n    },\r\n  },\r\n  booleanToYesNo: {\r\n    transform: function(value) {\r\n      return value ? 'Yes' : 'No';\r\n    }\r\n  },\r\n  thousandsPlace: {\r\n    transform: function(value) {\r\n      var number = String(value).match(/\\d+/)[0].replace(/(.)(?=(\\d{3})+$)/g,'$1,');\r\n      var label = String(value).replace(/[0-9]/g, '') || '';\r\n      return number + ' ' + label;\r\n    }\r\n  },\r\n  currency: {\r\n    // a list of global objects this transform depends on\r\n    globals: ['accounting'],\r\n    // this is the function that gets called to perform the transform\r\n    transform: function (value, globals) {\r\n      // var accounting = globals.accounting;\r\n      return accounting.formatMoney(value);\r\n    }\r\n  },\r\n  date: {\r\n    globals: ['moment'],\r\n    transform: function (value, globals) {\r\n      // var moment = globals.moment;\r\n      return moment(value).format('MM/DD/YYYY');\r\n    },\r\n  },\r\n  dayofweek: {\r\n    // a list of global objects this transform depends on\r\n    transform: function (value) {\r\n      switch(value) {\r\n        case \"FRI\":\r\n        value = \"Friday\";\r\n        break;\r\n        case \"SAT\":\r\n        value = \"Saturday\";\r\n        break;\r\n        case \"SUN\":\r\n        value = \"Sunday\";\r\n        break;\r\n        case \"MON\":\r\n        value = \"Monday\";\r\n        break;\r\n        case \"TUE\":\r\n        value = \"Tuesday\";\r\n        break;\r\n        case \"WED\":\r\n        value = \"Wednesday\";\r\n        break;\r\n        case \"THU\":\r\n        value = \"Thursday\";\r\n      };\r\n      return value\r\n    }\r\n  },\r\n  feet: {\r\n    transform: function (value) {\r\n      return value && value + ' ft';\r\n    },\r\n  },\r\n  getNearest: {\r\n    transform: function(state, field, distName) {\r\n      let min = Math.min.apply(null, state.sources[field].data.map(function(item) {return item[distName];}));\r\n      let result  = state.sources[field].data.filter(function(item){return item[distName] == min;} );\r\n      let nearest = result? result[0] : null;\r\n      return nearest\r\n    }\r\n  },\r\n  integer: {\r\n    transform: function (value) {\r\n      return !isNaN(value) && parseInt(value);\r\n    },\r\n  },\r\n  nowrap: {\r\n    transform: function (value) {\r\n      return '<span style=\"white-space: nowrap;\">' + value + '</span>';\r\n    },\r\n  },\r\n  nth: {\r\n     transform: function(n) {\r\n       return n + ([,'st','nd','rd'][n%100>>3^1&&n%10]||'th')\r\n     }\r\n  },\r\n  phoneNumber: {\r\n    transform: function (value) {\r\n      var s2 = (\"\"+value).replace(/\\D/g, '');\r\n      var m = s2.match(/^(\\d{3})(\\d{3})(\\d{4})$/);\r\n      return (!m) ? null : \"(\" + m[1] + \") \" + m[2] + \"-\" + m[3];\r\n    }\r\n  },\r\n  prettyNumber: {\r\n    transform: function (value) {\r\n      return !isNaN(value) && value.toLocaleString();\r\n    },\r\n  },\r\n  rcoPrimaryContact: {\r\n    transform: function (value) {\r\n      var PHONE_NUMBER_PAT = /\\(?(\\d{3})\\)?( |-)?(\\d{3})(-| )?(\\d{4})/g;\r\n      var m = PHONE_NUMBER_PAT.exec(value);\r\n\r\n      // check for non-match\r\n      if (!m) {\r\n        return value;\r\n      }\r\n\r\n      // standardize phone number\r\n      var std = ['(', m[1], ') ', m[3], '-', m[5]].join('');\r\n      var orig = m[0]\r\n      var valueStd = value.replace(orig, std);\r\n\r\n      return valueStd;\r\n    }\r\n  },\r\n  squareFeet: {\r\n    transform: function (value) {\r\n      return value && value + ' sq ft';\r\n    },\r\n  },\r\n  titleCase: {\r\n    transform: function(str) {\r\n      str = str.toLowerCase().split(' ').map(function(word) {\r\n        return (word.charAt(0).toUpperCase() + word.slice(1));\r\n      });\r\n      return str.join(' ');\r\n    }\r\n  },\r\n  urlFormatter: {\r\n    transform: function(txt) {\r\n      var uselessWordsArray =\r\n        [\r\n          \"http//\", \"http://\", \"https://\", \"www.\", \"//\", \"//:\"\r\n        ];\r\n      var expStr = uselessWordsArray.join(\"|\");\r\n      return txt.replace(new RegExp(expStr, 'gi'), '');\r\n    }\r\n  },\r\n}\r\n","import helpers from '../util/helpers';\r\n\r\nexport default {\r\n  id: 'condoList',\r\n  type: 'http-get',\r\n  url: '//api.phila.gov/ais/v1/search/',\r\n  options: {\r\n    params: {\r\n      urlAddition: function (feature) {\r\n        return feature.properties.street_address;\r\n      },\r\n      gatekeeperKey: helpers.GATEKEEPER_KEY,\r\n      include_units: true,\r\n      opa_only: true,\r\n      page: 1,\r\n    },\r\n    success: function(data) {\r\n      return data;\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'crimeIncidents',\r\n  type: 'http-get-nearby',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    table: 'incidents_part1_part2',\r\n    dateMinNum: 1,\r\n    dateMinType: 'year',\r\n    dateField: 'dispatch_date',\r\n    params: {},\r\n    distances: 250,\r\n  }\r\n}\r\n","import helpers from '../util/helpers';\r\n\r\nexport default {\r\n  id: 'dorDocuments',\r\n  type: 'http-get',\r\n  targets: {\r\n    get: function(state) {\r\n      return state.parcels.dor.data;\r\n    },\r\n    getTargetId: function(target) {\r\n      return target.properties.OBJECTID;\r\n    },\r\n  },\r\n  // url: '//gis.phila.gov/arcgis/rest/services/DOR/rtt_service/MapServer/0/query',\r\n  url: '//services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/RTT_SUMMARY/FeatureServer/0/query',\r\n  options: {\r\n    params: {\r\n      where: function (feature, state) {\r\n        // METHOD 1: via address\r\n        var parcelBaseAddress = helpers.concatDorAddress(feature);\r\n        var geocode = state.geocode.data.properties;\r\n\r\n        // REVIEW if the parcel has no address, we don't want to query\r\n        // WHERE ADDRESS = 'null' (doesn't make sense), so use this for now\r\n        if (!parcelBaseAddress || parcelBaseAddress === 'null'){\r\n          var where = \"MATCHED_REGMAP = '\" + state.parcels.dor.data[0].properties.BASEREG + \"'\";\r\n        } else {\r\n          var addressLow = state.geocode.data.properties.address_low,\r\n              addressFloor = Math.floor(addressLow / 100, 1) * 100,\r\n              addressRemainder = addressLow - addressFloor,\r\n              where = \"((ADDRESS_LOW = \" + addressLow\r\n                    + \" OR (ADDRESS_LOW >= \" + addressFloor + \" AND ADDRESS_LOW <= \" + addressLow + \" AND ADDRESS_HIGH >= \" + addressRemainder + \" ))\"\r\n                    + \" AND STREET_NAME = '\" + geocode.street_name\r\n                    + \"' AND STREET_SUFFIX = '\" + geocode.street_suffix\r\n                    + \"'\"\r\n          if (geocode.street_predir != '') {\r\n            where += \" AND STREET_PREDIR = '\" + geocode.street_predir + \"'\";\r\n          }\r\n          if (geocode.address_low_suffix != '') {\r\n            where += \" AND ADDRESS_LOW_SUFFIX = '\" + geocode.address_low_suffix + \"'\";\r\n          }\r\n          // this is hardcoded right now to handle DOR address suffixes that are actually fractions\r\n          if (geocode.address_low_frac === '1/2') {\r\n            where += \" AND ADDRESS_LOW_SUFFIX = '2'\" //+ geocode.address_low_frac + \"'\";\r\n          }\r\n          if (geocode.street_postdir != '') {\r\n            where += \" AND STREET_POSTDIR = '\" + geocode.street_postdir + \"'\";\r\n          }\r\n\r\n          // check for unit num\r\n          var unitNum = helpers.cleanDorAttribute(feature.properties.UNIT),\r\n              unitNum2 = geocode.unit_num;\r\n          if (unitNum) {\r\n            where += \" AND UNIT_NUM = '\" + unitNum + \"'\";\r\n          } else if (unitNum2 != '') {\r\n            where += \" AND UNIT_NUM = '\" + unitNum2 + \"'\";\r\n          }\r\n\r\n          where += \") or MATCHED_REGMAP = '\" + state.parcels.dor.data[0].properties.BASEREG + \"'\";\r\n          where += \" or REG_MAP_ID = '\" + state.parcels.dor.data[0].properties.BASEREG + \"'\";\r\n          // where += \") OR (STREET_ADDRESS='\" + parcelBaseAddress + \"'\";\r\n          // if (unitNum) {\r\n          //   where +=\"AND UNIT_NUM = '\" + unitNum + \"'\";\r\n          // }\r\n          // where += \")\"\r\n        }\r\n\r\n        // METHOD 2: via parcel id - the layer doesn't have mapreg yet, though\r\n        // var mapreg = feature.properties.MAPREG;\r\n        // var where = `MAPREG = '${mapreg}'`;\r\n\r\n        // console.log('dor docs where', where);\r\n\r\n        return where;\r\n      },\r\n      outFields: \"DOCUMENT_ID, DISPLAY_DATE, DOCUMENT_TYPE, GRANTORS, GRANTEES, DISCREPANCY\",\r\n      // outFields: \"R_NUM, DISPLAY_DATE, DOCUMENT_TYPE, GRANTORS, GRANTEES, DISCREPANCY\",\r\n      returnDistinctValues: 'true',\r\n      returnGeometry: 'false',\r\n      f: 'json'\r\n    },\r\n    success: function(data) {\r\n      return data.features;\r\n    }\r\n  },\r\n}\r\n","export default {\r\n  id: 'liBusinessLicenses',\r\n  type: 'http-get',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      // q: function(feature){ return \"select * from li_business_licenses where street_address = '\" + feature.properties.street_address + \"'\"},// + \"' or addresskey = '\" + feature.properties.li_address_key.toString() + \"'\",\r\n      q: function(feature){ return \"select * from li_business_licenses where eclipse_addressobjectid = '\" + feature.properties.eclipse_location_id + \"'\"},\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'regmaps',\r\n  type: 'esri',\r\n  url: '//services.arcgis.com/fLeGjb7u4uXqeF9q/arcgis/rest/services/MASTERMAPINDEX/FeatureServer/0',\r\n  // deps: ['dorParcels'],\r\n  deps: ['parcels.dor'],\r\n  options: {\r\n    relationship: 'intersects',\r\n    targetGeometry: function (state, Leaflet) {\r\n      // get combined extent of dor parcels\r\n      // var parcels = state.dorParcels.data;\r\n      var parcels = state.parcels.dor.data;\r\n\r\n      // build up sets of x and y values\r\n      var xVals = [],\r\n          yVals = [];\r\n\r\n      // loop over parcels\r\n      parcels.forEach(function (parcel) {\r\n        var geom = parcel.geometry,\r\n            parts = geom.coordinates;\r\n\r\n        // loop over parts (whether it's simple or multipart)\r\n        parts.forEach(function (coordPairs) {\r\n          coordPairs.forEach(function (coordPair) {\r\n            // console.log('coordPair', coordPair);\r\n\r\n            // if the polygon has a hole, it has another level of coord\r\n            // pairs, presumably one for the outer coords and another for\r\n            // inner. for simplicity, add them all.\r\n            var hasHole = Array.isArray(coordPair[0]);\r\n\r\n            if (hasHole) {\r\n              // loop through inner pairs\r\n              coordPair.forEach(function (innerCoordPair) {\r\n                var x = innerCoordPair[0],\r\n                    y = innerCoordPair[1];\r\n\r\n                xVals.push(x);\r\n                yVals.push(y)\r\n              });\r\n            // for all other polys\r\n            } else {\r\n              var x = coordPair[0],\r\n                  y = coordPair[1];\r\n\r\n              xVals.push(x);\r\n              yVals.push(y)\r\n            }\r\n          });\r\n        });\r\n      });\r\n\r\n      // take max/min\r\n      var xMin = Math.min.apply(null, xVals);\r\n      var xMax = Math.max.apply(null, xVals);\r\n      var yMin = Math.min.apply(null, yVals);\r\n      var yMax = Math.max.apply(null, yVals);\r\n\r\n      // make sure all coords are defined. no NaNs allowed.\r\n      var coordsAreDefined = [xMin, xMax, yMin, yMax].every(\r\n        function (coord) { return coord; }\r\n      );\r\n\r\n      // if they aren't\r\n      if (!coordsAreDefined) {\r\n        //  exit with null to avoid an error calling lat lng bounds\r\n        // constructor\r\n        return null;\r\n      }\r\n\r\n      // construct geometry\r\n      var bounds = Leaflet.latLngBounds([\r\n        [yMin, xMin],\r\n        [yMax, xMax]\r\n      ]);\r\n\r\n      return bounds;\r\n    },\r\n  },\r\n  success: function(data) {\r\n    return data;\r\n  }\r\n}\r\n","export default {\r\n  id: 'sanitationCenters',\r\n  type: 'http-get-nearby',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    table: 'sanitation_convenience_centers',\r\n    params: {},\r\n    distances: 30000,\r\n  }\r\n}\r\n","import helpers from '../util/helpers';\r\nimport transforms from '../general/transforms';\r\n\r\nconst titleCase = transforms.titleCase.transform;\r\n\r\nexport default {\r\n  key: 'property',\r\n  icon: 'home',\r\n  label: 'Property Assessments',\r\n  // REVIEW can these be calculated from vue deps?\r\n  dataSources: ['assessmentHist', 'opa', 'zoningBase', 'zoningAppeals', 'zoningOverlay', 'rco'],\r\n  components: [\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: '\\\r\n          Property assessment and sale information for this address. Source: Office of Property Assessments (OPA). OPA was formerly a part of the Bureau of Revision of Taxes (BRT) and some City records may still use that name.\\\r\n        '\r\n      }\r\n    },\r\n    {\r\n      type: 'vertical-table',\r\n      slots: {\r\n        fields: [\r\n          {\r\n            label: 'Owners',\r\n            value: function(state) {\r\n              var owners = state.geocode.data.properties.opa_owners;\r\n              var ownersJoined = owners.join(', ');\r\n              return titleCase(ownersJoined);\r\n            }\r\n          },\r\n          {\r\n            label: 'OPA Address',\r\n            value: function(state) {\r\n              return titleCase(state.geocode.data.properties.street_address) +\r\n                     '<br>Philadelphia, PA ' + state.geocode.data.properties.zip_code;\r\n            }\r\n          },\r\n          {\r\n            label: 'Mailing Address',\r\n            value: function(state) {\r\n              let opa = state.sources.opa.data\r\n              const mailing = [];\r\n              opa.mailing_care_of.length > 0 ? mailing.push(titleCase(opa.mailing_care_of) +'<br>'):null;\r\n              opa.mailing_address_1.length > 0 ? mailing.push(titleCase(opa.mailing_address_1) +'<br>'):null;\r\n              opa.mailing_address_2.length > 0 ? mailing.push(titleCase(opa.mailing_address_2) +'<br>'):null;\r\n              console.log(mailing);\r\n              return opa.mailing_street.length > 0 ?\r\n                     mailing.join('') + titleCase(opa.mailing_street) +\r\n                     '<br>'+ titleCase(opa.mailing_city_state).replace(/\\w$/, c => c.toUpperCase()) +\r\n                     '<br>'+ opa.mailing_zip : titleCase(opa.location) +\r\n                     '<br> Philadelphia, PA '+ [opa.zip_code.slice(0, 5), \"-\", opa.zip_code.slice(5)].join('');\r\n            }\r\n          },\r\n        ],\r\n      },\r\n      options: {\r\n        id: 'opaData',\r\n        // requiredSources: ['opa'],\r\n        externalLink: {\r\n          action: function() {\r\n            return 'View the Real Estate Tax Balance';\r\n          },\r\n          href: function() {\r\n            return '//legacy.phila.gov/revenue/realestatetax/';\r\n          }\r\n        }\r\n      }\r\n    },\r\n    {\r\n      type: 'vertical-table',\r\n      options: {\r\n        nullValue: 'None',\r\n      },\r\n      slots: {\r\n        title: 'Property Characteristics',\r\n        fields: [\r\n          {\r\n            label: 'OPA Account #',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.opa_account_num;\r\n            }\r\n          },\r\n          {\r\n            label: 'Homestead Exemption',\r\n            value: function(state) {\r\n              if (state.sources.opa.data.homestead_exemption > 0) {\r\n                return state.sources.opa.data.homestead_exemption\r\n              } else {\r\n                return \"No\"\r\n              }\r\n            },\r\n          },\r\n          {\r\n            label: 'Description',\r\n            value: function(state) {\r\n              return titleCase(state.sources.opa.data.building_code_description);\r\n            },\r\n          },\r\n          {\r\n            label: 'Condition',\r\n            value: function(state) {\r\n              const exterior = state.sources.opa.data.exterior_condition\r\n              const condition =  exterior  == 0 ? 'Not Applicable' :\r\n              exterior  == 2 ? 'Newer Construction / Rehabbed' :\r\n              exterior  == 3 ? 'Above Average' :\r\n              exterior  == 4 ? 'Average' :\r\n              exterior  == 5 ? 'Below Average' :\r\n              exterior  == 6 ? 'Vacant' :\r\n              exterior  == 7 ? 'Sealed / Structurally Compromised, Open to the Weather' :\r\n              'Not available';\r\n              return condition;\r\n            },\r\n          },\r\n          {\r\n            label: 'Beginning Point',\r\n            value: function(state) {\r\n              return titleCase(state.sources.opa.data.beginning_point);\r\n            },\r\n          },\r\n          {\r\n            label: 'Land Area',\r\n            value: function(state) {\r\n              return state.sources.opa.data.total_area;\r\n            },\r\n            transforms: [\r\n              'integer',\r\n              'prettyNumber',\r\n              'squareFeet',\r\n            ]\r\n          },\r\n          {\r\n            label: 'Improvement Area',\r\n            value: function(state) {\r\n              return state.sources.opa.data.total_livable_area;\r\n            },\r\n            transforms: [\r\n              'integer',\r\n              'prettyNumber',\r\n              'squareFeet',\r\n            ]\r\n          },\r\n        ],\r\n      },\r\n    }, // end table\r\n    {\r\n      type: 'vertical-table',\r\n      options: {},\r\n      slots: {\r\n        title: 'Sales Details',\r\n        fields: [\r\n          {\r\n            label: 'Sales Price',\r\n            value: function(state) {\r\n              return state.sources.opa.data.sale_price;\r\n            },\r\n            transforms: [\r\n              'currency'\r\n            ]\r\n          },\r\n          {\r\n            label: 'Sales Date',\r\n            value: function(state) {\r\n              return state.sources.opa.data.sale_date;\r\n            },\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n        ],\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        id: 'valueHist',\r\n        fields: [\r\n          {\r\n            label: 'Year',\r\n            value: function(state, item){\r\n              return item.year\r\n            }\r\n          },\r\n          {\r\n            label: 'Market Value',\r\n            value: function(state, item){\r\n              return item.market_value || \"$0\"\r\n            },\r\n            transforms: ['currency'],\r\n          },\r\n          {\r\n            label: 'Taxable Land',\r\n            value: function(state, item){\r\n              return item.taxable_land || \"$0\"\r\n            },\r\n            transforms: ['currency'],\r\n          },\r\n          {\r\n            label: 'Taxable Improvement',\r\n            value: function(state, item){\r\n              return item.taxable_building || \"$0\"\r\n            },\r\n            transforms: ['currency'],\r\n          },\r\n          {\r\n            label: 'Exempt Land',\r\n            value: function(state, item){\r\n              return item.exempt_land || \"$0\"\r\n            },\r\n            transforms: ['currency'],\r\n          },\r\n          {\r\n            label: 'Exempt Improvement',\r\n            value: function(state, item){\r\n              return item.exempt_building || \"$0\"\r\n            },\r\n            transforms: ['currency']\r\n          },\r\n        ],\r\n        sort: {\r\n          // this should return the val to sort on\r\n          getValue: function(item) {\r\n            return item.year;\r\n          },\r\n          // asc or desc\r\n          order: 'desc'\r\n        },\r\n      },\r\n      slots: {\r\n        title: 'Valuation History',\r\n        items: function(state) {\r\n          var data = state.sources['assessmentHist'].data.rows;\r\n          var rows = data.map(function(row){\r\n            var itemRow = row;\r\n            return itemRow;\r\n          });\r\n          return rows;\r\n        },\r\n      },\r\n    },\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: '\\\r\n          Corrections to or questions about this property? \\\r\n          <br><a href=\"//opa.phila.gov/opa.apps/Help/CitizenMain.aspx?sch=Ctrl2&s=1&url=search&id=3172000144\"\\\r\n          target=\"_blank\">Submit an Official Inquiry</a> to the Office of Property Assessment\\\r\n        ',\r\n      },\r\n    },\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        title: \"Access the Raw Data\",\r\n        text: '\\\r\n          You can download the property assessment dataset in bulk, and get more information about this data at\\\r\n          <a href=\"//metadata.phila.gov/#home/datasetdetails/5543865f20583086178c4ee5/\"\\\r\n          target=\"_blank\">metadata.phila.gov</a> \\\r\n        ',\r\n      },\r\n    },\r\n  ],\r\n  basemap: 'pwd',\r\n  identifyFeature: 'address-marker',\r\n  // we might not need this anymore, now that we have identifyFeature\r\n  parcels: 'pwd',\r\n  errorMessage: function (state) {\r\n    var data = state.sources.condoList.data;\r\n        // features = data.features;\r\n\r\n    if (data) {\r\n      var numCondos = data.total_size;\r\n\r\n      if (numCondos > 0) {\r\n        var shouldPluralize = numCondos > 1,\r\n            isOrAre = shouldPluralize ? 'are' : 'is',\r\n            unitOrUnits = shouldPluralize ? 'units' : 'unit',\r\n            message = [\r\n              '<h3>',\r\n              'There ',\r\n              isOrAre,\r\n              // ' <strong>',\r\n              ' ',\r\n              numCondos,\r\n              ' condominium ',\r\n              unitOrUnits,\r\n              // '</strong> at this address.</h3>',\r\n              ' at this address.</h3>',\r\n              // ' at this address. ',\r\n              '<p>You can use the Condominiums tab below to see information for an individual unit.</p>'\r\n              // 'Please select a unit from the Condominiums tab below.'\r\n            ].join('');\r\n\r\n        return message;\r\n      }\r\n    } else {\r\n      return 'There is no property assessment record for this address.';\r\n    }\r\n  },\r\n}\r\n","export default {\r\n  key: 'condos',\r\n  icon: 'building',\r\n  label: 'Condominiums',\r\n  dataSources: ['condoList'],\r\n  // showTopicBasedOnOtherData takes precedence over showTopicOnlyIfDataExists\r\n  showTopicBasedOnOtherData: {\r\n    'otherData': {\r\n      'opa': {\r\n        data: undefined\r\n      }\r\n    },\r\n    'requiredData': {\r\n      'condoList': {\r\n        pathToDataArray: ['features'],\r\n        minDataLength: 1,\r\n      }\r\n    }\r\n  },\r\n  // showTopicOnlyIfDataExists can be overruled by showTopicBasedOnOtherData\r\n  showTopicOnlyIfDataExists: {\r\n    'condoList': {\r\n      pathToDataArray: ['features'],\r\n      minDataLength: 2,\r\n    }\r\n  },\r\n  components: [\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: 'Condominium units at your search address, as recorded for property assessment purposes. Click one of the addresses below to see information for that unit.  Use the back button to return to this list. Source: Office of Property Assessment'\r\n      }\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'condominiums',\r\n        id: 'condoList',\r\n        useApiCount: true,\r\n        defaultIncrement: 25,\r\n        fields: [\r\n          {\r\n            label: 'Address',\r\n            value: function (state, item) {\r\n              var address = item.properties.street_address;\r\n              return '<a href=\"#/' + address + '/property\">' + address + '</a>';\r\n            },\r\n          },\r\n          {\r\n            label: 'OPA Account #',\r\n            value: function (state, item) {\r\n              return item.properties.opa_account_num;\r\n            },\r\n          },\r\n        ], // end fields\r\n        // sort: {\r\n        //   // this should return the val to sort on\r\n        //   getValue: function(item) {\r\n        //     // return item.attributes.RECORDING_DATE;\r\n        //     return item.attributes.DOCUMENT_DATE;\r\n        //   },\r\n        //   // asc or desc\r\n        //   order: 'desc'\r\n        // }\r\n      },\r\n      slots: {\r\n        title: 'Condominiums',\r\n        highestPageRetrieved: function(state) { return state.sources['condoList'].data.page },\r\n        pageCount: function(state) { return state.sources['condoList'].data.page_count },\r\n        totalSize: function(state) { return state.sources['condoList'].data.total_size },\r\n        items: function(state) {\r\n          var data = state.sources['condoList'].data.features;\r\n          var rows = data.map(function(row){\r\n            var itemRow = row;\r\n            return itemRow;\r\n          });\r\n          return rows;\r\n        },\r\n      } // end slots\r\n    },\r\n  ],\r\n  basemap: 'pwd',\r\n  identifyFeature: 'address-marker',\r\n  // we might not need this anymore, now that we have identifyFeature\r\n  parcels: 'pwd'\r\n}\r\n","import helpers from '../util/helpers';\r\n\r\nexport default {\r\n  key: 'deeds',\r\n  icon: 'book',\r\n  label: 'Deeds',\r\n  // TODO uncommenting this causes the no-content view to show up.\r\n  // dataSources: ['dorDocuments'],\r\n  components: [\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: '\\\r\n          Deed information and document transactions for this address.\\\r\n          The map faithfully reflects property boundaries as described in \\\r\n          recorded deeds including multiple types of easements.\\\r\n          The property boundaries displayed on the map are for reference \\\r\n          only and should not be used in place of the recorded deeds or \\\r\n          land surveys. Source: Department of Records\\\r\n        ',\r\n      }\r\n    },\r\n    {\r\n      type: 'collection-summary',\r\n      options: {\r\n        descriptor: 'parcel',\r\n        // this will include zero quantities\r\n        // includeZeroes: true,\r\n        getValue: function(item) {\r\n          return item.properties.STATUS;\r\n        },\r\n        context: {\r\n          singular: function(list){ return 'There is ' + list + ' at this address.'},\r\n          plural: function(list){ return 'There are ' + list + ' at this address.'}\r\n        },\r\n        types: [\r\n          {\r\n            value: 1,\r\n            label: 'active parcel'\r\n          },\r\n          {\r\n            value: 2,\r\n            label: 'inactive parcel'\r\n          },\r\n          {\r\n            value: 3,\r\n            label: 'remainder parcel'\r\n          }\r\n        ]\r\n      },\r\n      slots: {\r\n        items: function(state) {\r\n          // return state.dorParcels.data;\r\n          return state.parcels.dor.data;\r\n        }\r\n      }\r\n    },\r\n    {\r\n      type: 'tab-group',\r\n      options: {\r\n        getKey: function(item) {\r\n          return item.properties.OBJECTID;\r\n        },\r\n        getTitle: function(item) {\r\n          return item.properties.MAPREG;\r\n        },\r\n        getAddress: function(item) {\r\n          var address = helpers.concatDorAddress(item);\r\n          return address;\r\n        },\r\n        // components for the content pane. this essentially a topic body.\r\n        components: [\r\n        //   {\r\n        //     type: 'table-group',\r\n        //     options: {\r\n        //       showBoth: {\r\n        //         mainTable: {\r\n        //           dataSource: null,\r\n        //           id:'dorData',\r\n        //         },\r\n        //         dependentTable: {\r\n        //           dataSource: 'condoList',\r\n        //           id: 'condoList_dor',\r\n        //         }\r\n        //       },\r\n        //       components: [\r\n\r\n          {\r\n            type: 'vertical-table',\r\n            options: {\r\n              nullValue: 'None',\r\n              // id: 'dorData',\r\n            },\r\n            slots: {\r\n              title: 'Parcel Details',\r\n              fields: [\r\n                {\r\n                  label: 'Map Registry #',\r\n                  value: function(state, item) {\r\n                    return item.properties.MAPREG;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Parcel Address',\r\n                  value: function(state, item) {\r\n                    return helpers.concatDorAddress(item);\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Status',\r\n                  value: function(state, item) {\r\n                    var status = item.properties.STATUS;\r\n                    var desc;\r\n                    switch(status) {\r\n                      case 1:\r\n                        desc = 'Active';\r\n                        break;\r\n                      case 2:\r\n                        desc = 'Inactive';\r\n                        break;\r\n                      case 3:\r\n                        desc = 'Remainder';\r\n                        break;\r\n                      default:\r\n                        break;\r\n                    }\r\n                    return desc;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Origination Date',\r\n                  value: function(state, item) {\r\n                    return item.properties.ORIG_DATE;\r\n                  },\r\n                  transforms: [\r\n                    'date'\r\n                  ]\r\n                },\r\n                {\r\n                  label: 'Inactive Date',\r\n                  value: function(state, item) {\r\n                    return item.properties.INACTDATE;\r\n                  },\r\n                  transforms: [\r\n                    'date'\r\n                  ]\r\n                },\r\n                {\r\n                  label: 'Has Air Rights',\r\n                  value: function(state, item) {\r\n                    var suffix = item.properties.SUFFIX;\r\n                    return suffix === 'A' ? 'Yes' : 'No';\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Is Condo',\r\n                  value: function(state, item) {\r\n                    if (!item.properties.CONDOFLAG) {\r\n                      return 'No';\r\n                    } else {\r\n                      return 'Yes';\r\n                    }\r\n                    // return item.properties.CONDOFLAG ? 'Yes' : 'No';\r\n                  },\r\n                  // fieldFunction: function(state, item) {\r\n                  //   console.log('state', state);\r\n                  // }\r\n                },\r\n                {\r\n                  label: 'Perimeter',\r\n                  value: function (state, item) {\r\n                    return (item.properties || {})['TURF_PERIMETER'];\r\n                  },\r\n                  transforms: [\r\n                    'integer',\r\n                    'prettyNumber',\r\n                    'feet',\r\n                  ]\r\n                },\r\n                {\r\n                  label: 'Area',\r\n                  value: function(state, item) {\r\n                    return (item.properties || {})['TURF_AREA'];\r\n                  },\r\n                  transforms: [\r\n                    'integer',\r\n                    'prettyNumber',\r\n                    'squareFeet',\r\n                  ]\r\n                },\r\n              ]\r\n            }  // end slots\r\n          },  // end vertical table\r\n          // {\r\n          //   type: 'horizontal-table',\r\n          //   options: {\r\n          //     topicKey: 'dor',\r\n          //     id: 'condoList',\r\n          //     shouldShowButton: true,\r\n          //     useApiCount: true,\r\n          //     // limit: 100,\r\n          //     fields: [\r\n          //       {\r\n          //         label: 'OPA Account',\r\n          //         value: function(state, item) {\r\n          //           var url = window.location.origin + window.location.pathname + '#/' + item.properties.opa_account_num + '/opa'\r\n          //           return \"<a href=\"+url+\">\"+item.properties.opa_account_num+\" <i class='fa fa-external-link'></i></a>\";\r\n          //         },\r\n          //       },\r\n          //       {\r\n          //         label: 'Address',\r\n          //         value: function(state, item) {\r\n          //           var url = window.location.origin + window.location.pathname + '#/' + item.properties.opa_account_num + '/opa'\r\n          //           return \"<a href=\"+url+\">\"+item.properties.street_address+\" <i class='fa fa-external-link'></i></a>\";\r\n          //         },\r\n          //       },\r\n          //       {\r\n          //         label: 'Owners',\r\n          //         value: function(state, item) {\r\n          //           var owners = item.properties.opa_owners;\r\n          //           var ownersJoined = owners.join(', ');\r\n          //           return ownersJoined;\r\n          //         }\r\n          //       }\r\n          //     ], // end fields\r\n          //     // sort: {\r\n          //     //   // this should return the val to sort on\r\n          //     //   getValue: function(item) {\r\n          //     //     // return item.attributes.RECORDING_DATE;\r\n          //     //     return item.attributes.DOCUMENT_DATE;\r\n          //     //   },\r\n          //     //   // asc or desc\r\n          //     //   order: 'desc'\r\n          //     // }\r\n          //   },\r\n          //   slots: {\r\n          //     title: 'Condominiums',\r\n          //     highestPageRetrieved: function(state) { return state.sources['condoList'].data.page },\r\n          //     pageCount: function(state) { return state.sources['condoList'].data.page_count },\r\n          //     totalSize: function(state) { return state.sources['condoList'].data.total_size },\r\n          //     items: function(state) {\r\n          //       var data = state.sources['condoList'].data.features;\r\n          //       var rows = data.map(function(row){\r\n          //         var itemRow = row;\r\n          //         return itemRow;\r\n          //       });\r\n          //       return rows;\r\n          //     },\r\n          //   } // end slots\r\n          // },\r\n\r\n          //     ]\r\n          //   }\r\n          // },\r\n          // REVIEW this callout should only show up when the condos tab\r\n          // is visible. commenting out for now.\r\n          // {\r\n          //   type: 'callout',\r\n          //   slots: {\r\n          //     text: 'Condominium units associated with this parcel.\\\r\n          //       This list may differ from the Condominiums tab above based\\\r\n          //       on how the deed was recorded. Source: Department of Records'\r\n          //   },\r\n          // },\r\n          {\r\n            type: 'horizontal-table',\r\n            options: {\r\n              topicKey: 'deeds',\r\n              id: 'dorCondoList',\r\n              defaultIncrement: 10,\r\n              showAllRowsOnFirstClick: true,\r\n              showOnlyIfData: true,\r\n              fields: [\r\n                {\r\n                  label: 'Condo Parcel',\r\n                  value: function(state, item) {\r\n                    return item.recmap + '-' + item.condoparcel;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Condo Name',\r\n                  value: function(state, item) {\r\n                    // return item.attributes.RECORDING_DATE;\r\n                    return item.condo_name;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Unit #',\r\n                  value: function(state, item) {\r\n                    return 'Unit #' + item.condounit;\r\n                  },\r\n                },\r\n                // {\r\n                //   label: 'Grantor',\r\n                //   value: function(state, item) {\r\n                //     return item.attributes.GRANTORS;\r\n                //   },\r\n                // },\r\n                // {\r\n                //   label: 'Grantee',\r\n                //   value: function(state, item) {\r\n                //     return item.attributes.GRANTEES;\r\n                //   },\r\n                // },\r\n              ], // end fields\r\n              sort: {\r\n                // this should return the val to sort on\r\n                getValue: function(item) {\r\n                  // return item.attributes.RECORDING_DATE;\r\n                  return item.condounit;\r\n                },\r\n                // asc or desc\r\n                order: 'asc'\r\n              }\r\n            },\r\n            slots: {\r\n              title: 'Deeded Condominiums',\r\n              items: function (state, item) {\r\n                var id = item.properties.OBJECTID,\r\n                    target = state.sources.dorCondoList.targets[id],\r\n                    data = target && target.data,\r\n                    rows = (data && data.rows) || [];\r\n\r\n                return rows\r\n              },\r\n            } // end slots\r\n          }, // end condos table\r\n\r\n          {\r\n            type: 'callout',\r\n            slots: {\r\n              text: 'The list of documents \\\r\n                shown below may not be a complete history of title to this \\\r\n                parcel. The list is based solely on documents recorded from\\\r\n                December 1999 forward where those documents contained street addresses\\\r\n                in the original recorded document.\\\r\n                <br> <br> \\\r\n               Discrepancies are indicated for deed documents from May, 2018 \\\r\n               to present. Discrepancy details may be accessed by clicking on \\\r\n               the link in the ID field.\\\r\n              '\r\n            },\r\n          },\r\n\r\n          {\r\n            type: 'horizontal-table',\r\n            options: {\r\n              topicKey: 'deeds',\r\n              id: 'dorDocuments',\r\n              defaultIncrement: 25,\r\n              fields: [\r\n                {\r\n                  label: 'ID',\r\n                  value: function (state, item) {\r\n                    return \"<a target='_blank' href='http://pdx-app01.city.phila.local/recorder/eagleweb/viewDoc.jsp?node=DOCC\"+item.attributes.DOCUMENT_ID+\"'>\"+item.attributes.DOCUMENT_ID+\"<i class='fa fa-external-link'></i></a>\"\r\n                    // return \"<a target='_blank' href='http://pdx-app01.city.phila.local/recorder/eagleweb/viewDoc.jsp?node=DOCC\"+item.attributes.R_NUM+\"'>\"+item.attributes.R_NUM+\"<i class='fa fa-external-link'></i></a>\"\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Date',\r\n                  value: function (state, item) {\r\n                    // return item.attributes.RECORDING_DATE;\r\n                    return item.attributes.DISPLAY_DATE;\r\n                  },\r\n                  nullValue: 'no date available',\r\n                  transforms: [\r\n                    'date'\r\n                  ]\r\n                },\r\n                {\r\n                  label: 'Type',\r\n                  value: function (state, item) {\r\n                    return item.attributes.DOCUMENT_TYPE;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Grantor',\r\n                  value: function (state, item) {\r\n                    return item.attributes.GRANTORS;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Grantee',\r\n                  value: function (state, item) {\r\n                    return item.attributes.GRANTEES;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Discrepancy',\r\n                  value: function (state, item) {\r\n                    return item.attributes.DISCREPANCY;\r\n                  },\r\n                },\r\n              ], // end fields\r\n              sort: {\r\n                // this should return the val to sort on\r\n                getValue: function (item) {\r\n                  // return item.attributes.RECORDING_DATE;\r\n                  return item.attributes.DISPLAY_DATE;\r\n                },\r\n                // asc or desc\r\n                order: 'desc'\r\n              }\r\n            },\r\n            slots: {\r\n              title: 'Documents',\r\n              // defaultIncrement: 25,\r\n              items: function (state, item) {\r\n                var id = item.properties.OBJECTID;\r\n                if (state.sources.dorDocuments.targets[id]) {\r\n                  return state.sources.dorDocuments.targets[id].data;\r\n                } else {\r\n                  return [];\r\n                }\r\n              },\r\n            } // end slots\r\n\r\n            // slots: {\r\n            //   title: 'Condominiums',\r\n            //   highestPageRetrieved: function(state) { return state.sources['condoList'].data.page },\r\n            //   pageCount: function(state) { return state.sources['condoList'].data.page_count },\r\n            //   totalSize: function(state) { return state.sources['condoList'].data.total_size },\r\n            //   items: function(state) {\r\n            //     var data = state.sources['condoList'].data.features;\r\n            //     var rows = data.map(function(row){\r\n            //       var itemRow = row;\r\n            //       return itemRow;\r\n            //     });\r\n            //     return rows;\r\n            //   },\r\n            // } // end slots\r\n\r\n          }, // end docs table\r\n        ] // end parcel tab content comps\r\n      }, // end parcel tab options\r\n      slots: {\r\n        items: function(state) {\r\n          // return state.dorParcels.data;\r\n          return state.parcels.dor.data;\r\n        }\r\n      },\r\n    }, // end dor parcel tab group comp\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: '\\\r\n          Use the buttons below to view images of hard-copy deed maps, some\\\r\n          of which have handwritten information that may be useful for\\\r\n          historical deed research.\\\r\n        ',\r\n      },\r\n    },\r\n    {\r\n      type: 'overlay-toggle-group',\r\n      options: {\r\n        getKey: function(item) {\r\n          return item.properties.RECMAP;\r\n        },\r\n      },\r\n      slots: {\r\n        title: 'Registry Maps',\r\n        items: function(state) {\r\n          return state.sources.regmaps.data;\r\n        }\r\n      }\r\n    },\r\n    // {\r\n    //   type: 'callout',\r\n    //   slots: {\r\n    //     text: 'The property boundaries displayed on the map are for reference only and may not be used in place of recorded deeds or land surveys. Source: Department of Records.'\r\n    //   }\r\n    // }\r\n  ], // end deeds comps\r\n  basemap: 'dor',\r\n  identifyFeature: 'dor-parcel',\r\n  // identifyFeature: 'address-marker',\r\n  // we might not need this anymore, now that we have identifyFeature\r\n  parcels: 'dor',\r\n  // parcels: 'pwd'\r\n  imageOverlayGroup: 'regmaps',\r\n}\r\n","export default {\r\n  key: 'li',\r\n  icon: 'wrench',\r\n  label: 'Licenses & Inspections',\r\n  dataSources: [\r\n    'liPermits',\r\n    'liInspections',\r\n    'liViolations',\r\n    'liBusinessLicenses',\r\n    'zoningDocs'\r\n  ],\r\n  components: [\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: '\\\r\n          Licenses, inspections, permits, property maintenance \\\r\n          violations, and zoning permit documents at your search address. \\\r\n          Source: Department of Licenses & Inspections\\\r\n        '\r\n      }\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'permits',\r\n        id: 'liPermits',\r\n        limit: 5,\r\n        fields: [\r\n          {\r\n            label: 'Date',\r\n            value: function(state, item){\r\n              return item.permitissuedate\r\n            },\r\n            nullValue: 'no date available',\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'ID',\r\n            value: function(state, item){\r\n              return \"<a target='_blank' href='//li.phila.gov/#details?entity=permits&eid=\"+item.permitnumber+\"&key=\"+item.addresskey+\"&address=\"+item.address+\"'>\"+item.permitnumber+\" <i class='fa fa-external-link'></i></a>\"\r\n            }\r\n          },\r\n          {\r\n            label: 'Description',\r\n            value: function(state, item){\r\n              return item.permitdescription\r\n            }\r\n          },\r\n          {\r\n            label: 'Status',\r\n            value: function(state, item){\r\n              return item.status\r\n            }\r\n          },\r\n        ],\r\n        sort: {\r\n          // this should return the val to sort on\r\n          getValue: function(item) {\r\n            return item.permitissuedate;\r\n          },\r\n          // asc or desc\r\n          order: 'desc'\r\n        },\r\n        externalLink: {\r\n          action: function(count) {\r\n            return 'See ' + count + ' older permits at L&I Property History';\r\n          },\r\n          name: 'L&I Property History',\r\n          href: function(state) {\r\n            var address = state.geocode.data.properties.street_address;\r\n            var addressEncoded = encodeURIComponent(address);\r\n            return '//li.phila.gov/#summary?address=' + addressEncoded;\r\n          }\r\n        }\r\n      },\r\n      slots: {\r\n        title: 'Permits',\r\n        items: function(state) {\r\n          var data = state.sources['liPermits'].data.rows;\r\n          var rows = data.map(function(row){\r\n            var itemRow = row;\r\n            return itemRow;\r\n          });\r\n          return rows;\r\n        },\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'zoning',\r\n        id: 'zoningDocs',\r\n        // limit: 100,\r\n        fields: [\r\n          {\r\n            label: 'Date',\r\n            value: function(state, item){\r\n              return item.scan_date\r\n            },\r\n            nullValue: 'no date available',\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'Permit Number',\r\n            value: function(state, item){\r\n              return item.permit_number\r\n            }\r\n          },\r\n          // {\r\n          //   label: 'Type',\r\n          //   value: function(state, item){\r\n          //     return item.doc_type\r\n          //   }\r\n          // },\r\n          {\r\n            label: '# Pages',\r\n            value: function(state, item){\r\n              return item.num_pages\r\n            }\r\n          },\r\n          {\r\n            label: 'ID',\r\n            value: function (state, item) {\r\n              console.log('zoning doc', item);\r\n\r\n              var appId = item.app_id;\r\n\r\n              if (appId.length < 3) {\r\n                appId = '0' + appId;\r\n              }\r\n\r\n              return '<a target=\"_blank\" href=\"//s3.amazonaws.com/lni-zoning-pdfs/'\r\n                      + item.doc_id\r\n                      + '.pdf\">'\r\n                      + item.doc_id\r\n                      + ' <i class=\"fa fa-external-link\"></i></a>'\r\n                      + '</a>'\r\n              // return item.appid + '-' + item.docid\r\n            }\r\n          },\r\n          // {\r\n          //   label: 'Link',\r\n          //   value: function(state, item){\r\n          //     // return \"<a href='//www.washingtonpost.com/'>View Scan</a>\"\r\n          //     return \"<a target='_blank' href='//www.phila.gov/zoningarchive/Preview.aspx?address=\" + item.address + \"&&docType=\" + item.doctype + \"&numofPages=\" + item.page_numbers + \"&docID=\" + item.docid + \"&app=\" + item.appid +\"'>View Scan <i class='fa fa-external-link'></i></a>\"\r\n          //   }\r\n          // },\r\n        ],\r\n        sort: {\r\n          // this should return the val to sort on\r\n          getValue: function(item) {\r\n            return item.scan_date;\r\n          },\r\n          // asc or desc\r\n          order: 'desc'\r\n        },\r\n      },\r\n      slots: {\r\n        title: 'Zoning Permit Documents',\r\n        subtitle: 'formerly \"Zoning Archive\"',\r\n        items: function(state) {\r\n          if (state.sources['zoningDocs'].data) {\r\n            if (state.sources['zoningDocs'].data.rows) {\r\n              var data = state.sources['zoningDocs'].data.rows;\r\n              var rows = data.map(function(row){\r\n                var itemRow = row;\r\n                // var itemRow = Object.assign({}, row);\r\n                //itemRow.DISTANCE = 'TODO';\r\n                return itemRow;\r\n              });\r\n              return rows;\r\n            }\r\n          }\r\n        },\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'permits',\r\n        id: 'liInspections',\r\n        limit: 5,\r\n        fields: [\r\n          {\r\n            label: 'Date',\r\n            value: function(state, item){\r\n              return item.inspectioncompleted\r\n            },\r\n            nullValue: 'no date available',\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'ID',\r\n            value: function(state, item){\r\n              return \"<a target='_blank' href='//li.phila.gov/#details?entity=violationdetails&eid=\"+item.casenumber+\"&key=\"+item.addresskey+\"&address=\"+item.address+\"'>\"+item.casenumber+\" <i class='fa fa-external-link'></i></a>\"\r\n              // return item.casenumber\r\n            }\r\n          },\r\n          {\r\n            label: 'Description',\r\n            value: function(state, item){\r\n              return item.inspectiondescription\r\n            }\r\n          },\r\n          {\r\n            label: 'Status',\r\n            value: function(state, item){\r\n              return item.inspectionstatus\r\n            }\r\n          },\r\n        ],\r\n        sort: {\r\n          // this should return the val to sort on\r\n          getValue: function(item) {\r\n            return item.inspectioncompleted;\r\n          },\r\n          // asc or desc\r\n          order: 'desc'\r\n        },\r\n        externalLink: {\r\n          action: function(count) {\r\n            // return `See ${count} older inspections at L&I Property History`;\r\n            return 'See ' + count + ' older inspections at L&I Property History';\r\n          },\r\n          name: 'L&I Property History',\r\n          href: function(state) {\r\n            var address = state.geocode.data.properties.street_address;\r\n            var addressEncoded = encodeURIComponent(address);\r\n            return '//li.phila.gov/#summary?address=' + addressEncoded;\r\n          }\r\n        }\r\n      },\r\n      slots: {\r\n        title: 'Inspections',\r\n        items: function(state) {\r\n          var data = state.sources['liInspections'].data.rows;\r\n          var rows = data.map(function(row){\r\n            var itemRow = row;\r\n            // var itemRow = Object.assign({}, row);\r\n            //itemRow.DISTANCE = 'TODO';\r\n            return itemRow;\r\n          });\r\n          // console.log('rows', rows);\r\n          return rows;\r\n        },\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'permits',\r\n        id: 'liViolations',\r\n        limit: 5,\r\n        fields: [\r\n          {\r\n            label: 'Date',\r\n            value: function(state, item){\r\n              return item.caseaddeddate\r\n            },\r\n            nullValue: 'no date available',\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'ID',\r\n            value: function(state, item){\r\n              return \"<a target='_blank' href='//li.phila.gov/#details?entity=violationdetails&eid=\"+item.casenumber+\"&key=\"+item.addresskey+\"&address=\"+item.address+\"'>\"+item.casenumber+\" <i class='fa fa-external-link'></i></a>\"\r\n              // return item.casenumber\r\n            }\r\n          },\r\n          {\r\n            label: 'Description',\r\n            value: function(state, item){\r\n              return item.violationdescription\r\n            }\r\n          },\r\n          {\r\n            label: 'Status',\r\n            value: function(state, item){\r\n              return item.status\r\n            }\r\n          },\r\n        ],\r\n        sort: {\r\n          // this should return the val to sort on\r\n          getValue: function(item) {\r\n            return item.caseaddeddate;\r\n          },\r\n          // asc or desc\r\n          order: 'desc'\r\n        },\r\n        externalLink: {\r\n          action: function(count) {\r\n            return 'See ' + count + ' older violations at L&I Property History';\r\n          },\r\n          name: 'L&I Property History',\r\n          href: function(state) {\r\n            var address = state.geocode.data.properties.street_address;\r\n            var addressEncoded = encodeURIComponent(address);\r\n            return '//li.phila.gov/#summary?address=' + addressEncoded;\r\n          }\r\n        }\r\n      },\r\n      slots: {\r\n        title: 'Violations',\r\n        items: function(state) {\r\n          var data = state.sources['liViolations'].data.rows;\r\n          var rows = data.map(function(row){\r\n            var itemRow = row;\r\n            // var itemRow = Object.assign({}, row);\r\n            //itemRow.DISTANCE = 'TODO';\r\n            return itemRow;\r\n          });\r\n          // console.log('rows', rows);\r\n          return rows;\r\n        },\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'permits',\r\n        id: 'liBusinessLicenses',\r\n        limit: 5,\r\n        fields: [\r\n          {\r\n            label: 'Issue Date',\r\n            value: function(state, item){\r\n              return item.initialissuedate\r\n            },\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'License Number',\r\n            value: function(state, item){\r\n              return \"<a target='_blank' href='//li.phila.gov/#details?entity=licenses&eid=\"+item.licensenum+\"&key=\"+item.street_address+\"&address=\"+item.street_address+\"'>\"+item.licensenum+\" <i class='fa fa-external-link'></i></a>\"\r\n              return item.licensenum\r\n            }\r\n          },\r\n          {\r\n            label: 'Name',\r\n            value: function(state, item){\r\n              return item.business_name\r\n            }\r\n          },\r\n          {\r\n            label: 'Type',\r\n            value: function(state, item){\r\n              return item.licensetype\r\n            }\r\n          },\r\n          {\r\n            label: 'Status',\r\n            value: function(state, item){\r\n              return item.licensestatus\r\n            }\r\n          },\r\n        ],\r\n        sort: {\r\n          // this should return the val to sort on\r\n          getValue: function(item) {\r\n            return item.caseaddeddate;\r\n          },\r\n          // asc or desc\r\n          order: 'desc'\r\n        },\r\n        externalLink: {\r\n          action: function(count) {\r\n            return 'See ' + count + ' older business licenses at L&I Property History';\r\n          },\r\n          name: 'L&I Property History',\r\n          href: function(state) {\r\n            var address = state.geocode.data.properties.street_address;\r\n            var addressEncoded = encodeURIComponent(address);\r\n            return '//li.phila.gov/#summary?address=' + addressEncoded;\r\n          }\r\n        }\r\n      },\r\n      slots: {\r\n        title: 'Business Licenses',\r\n        items: function(state) {\r\n          var data = state.sources['liBusinessLicenses'].data.rows;\r\n          var rows = data.map(function(row){\r\n            var itemRow = row;\r\n            // var itemRow = Object.assign({}, row);\r\n            //itemRow.DISTANCE = 'TODO';\r\n            return itemRow;\r\n          });\r\n          // console.log('rows', rows);\r\n          return rows;\r\n        },\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'permits',\r\n        id: 'liPermitsAdditional',\r\n        defaultIncrement: 25,\r\n        fields: [\r\n          {\r\n            label: 'Date',\r\n            value: function(state, item){\r\n              return item.attributes.PERMITISSUEDATE\r\n            },\r\n            nullValue: 'no date available',\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'ID',\r\n            value: function(state, item){\r\n              return \"<a target='_blank' href='//li.phila.gov/#details?entity=permits&eid=\"+item.attributes.PERMITNUMBER+\"&key=\"+item.attributes.ADDRESSKEY+\"&address=\"+item.attributes.ADDRESS+\"'>\"+item.attributes.PERMITNUMBER+\" <i class='fa fa-external-link'></i></a>\"\r\n            }\r\n          },\r\n          {\r\n            label: 'Building Area',\r\n            value: function(state, item){\r\n              return item.attributes.BLDGAREA\r\n            },\r\n            nullValue: 'no area available',\r\n            transforms: [\r\n              'thousandsPlace'\r\n            ]\r\n          },\r\n          {\r\n            label: 'Declared Value',\r\n            value: function(state, item){\r\n              return item.attributes.DECLAREDVALUE\r\n            },\r\n            nullValue: 'no value available',\r\n            transforms: [\r\n              'currency'\r\n            ]\r\n          },\r\n        ],\r\n        sort: {\r\n          // this should return the val to sort on\r\n          getValue: function(item) {\r\n            return item.attributes.PERMITISSUEDATE;\r\n          },\r\n          // asc or desc\r\n          order: 'desc'\r\n        },\r\n      },\r\n      slots: {\r\n        title: 'Building Area and Value',\r\n        items: function(state) {\r\n          var data = state.sources['liPermitsAdditional'].data;\r\n          if (data === null || data === undefined) {\r\n            return;\r\n          }\r\n          var rows = data.map(function(row){\r\n            var itemRow = row;\r\n            // var itemRow = Object.assign({}, row);\r\n            //itemRow.DISTANCE = 'TODO';\r\n            return itemRow;\r\n          });\r\n          // console.log('rows', rows);\r\n          return rows;\r\n        },\r\n      },\r\n    }\r\n\r\n  ],\r\n  basemap: 'pwd',\r\n  dynamicMapLayers: [\r\n    //'zoning'\r\n  ],\r\n  identifyFeature: 'address-marker',\r\n  parcels: 'pwd'\r\n}\r\n","import helpers from '../util/helpers';\r\n\r\nexport default {\r\n  key: 'zoning',\r\n  icon: 'university',\r\n  label: 'Zoning',\r\n  dataSources: [\r\n    'zoningOverlay',\r\n    'zoningBase',\r\n    'zoningAppeals',\r\n    'rco',\r\n  ],\r\n  components: [\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: 'Base district zoning maps, associated zoning overlays, and Registered Community Organizations applicable to your search address. Source: Department of Planning and Development'\r\n      }\r\n    },\r\n    {\r\n      type: 'collection-summary',\r\n      options: {\r\n        descriptor: 'parcel',\r\n        // this will include zero quantities\r\n        // includeZeroes: true,\r\n        getValue: function(item) {\r\n          return item.properties.STATUS;\r\n        },\r\n        context: {\r\n          singular: function(list){ return 'There is ' + list + ' at this address.'},\r\n          plural: function(list){ return 'There are ' + list + ' at this address.'}\r\n        },\r\n        types: [\r\n          {\r\n            value: 1,\r\n            label: 'active parcel'\r\n          },\r\n          {\r\n            value: 2,\r\n            label: 'inactive parcel'\r\n          },\r\n          {\r\n            value: 3,\r\n            label: 'remainder parcel'\r\n          }\r\n        ]\r\n      },\r\n      slots: {\r\n        items: function(state) {\r\n          // return state.dorParcels.data;\r\n          return state.parcels.dor.data;\r\n        }\r\n      }\r\n    },\r\n    {\r\n      type: 'tab-group',\r\n      options: {\r\n        getKey: function(item) {\r\n          return item.properties.OBJECTID;\r\n        },\r\n        getTitle: function(item) {\r\n          return item.properties.MAPREG;\r\n        },\r\n        getAddress: function(item) {\r\n          var address = concatDorAddress(item);\r\n          return address;\r\n        },\r\n        // components for the content pane. this essentially a topic body.\r\n        components: [\r\n          {\r\n            type: 'badge-custom',\r\n            options: {\r\n              titleBackground: '#58c04d',\r\n              components: [\r\n                {\r\n                  type: 'horizontal-table',\r\n                  options: {\r\n                    topicKey: 'zoning',\r\n                    shouldShowFilters: false,\r\n                    shouldShowHeaders: false,\r\n                    id: 'baseZoning',\r\n                    // defaultIncrement: 10,\r\n                    // showAllRowsOnFirstClick: true,\r\n                    // showOnlyIfData: true,\r\n                    fields: [\r\n                      {\r\n                        label: 'Code',\r\n                        value: function (state, item) {\r\n                          return item;\r\n                        },\r\n                        transforms: [\r\n                          'nowrap',\r\n                          'bold'\r\n                        ]\r\n                      },\r\n                      {\r\n                        label: 'Description',\r\n                        value: function (state, item) {\r\n                          return helpers.ZONING_CODE_MAP[item];\r\n                        },\r\n                      },\r\n                    ], // end fields\r\n                  },\r\n                  slots: {\r\n                    // title: 'Base Zoning',\r\n                    items(state, item) {\r\n                      // console.log('state.sources:', state.sources['zoningBase'].data.rows);\r\n                      const id = item.properties.OBJECTID;\r\n                      const target = state.sources.zoningBase.targets[id] || {};\r\n                      const { data={} } = target;\r\n                      const { rows=[] } = data;\r\n\r\n                      // get unique zoning codes\r\n                      const longCodes = rows.map(row => row.long_code);\r\n                      const longCodesUniqueSet = new Set(longCodes);\r\n                      const longCodesUnique = Array.from(longCodesUniqueSet);\r\n\r\n                      return longCodesUnique;\r\n                    },\r\n                  }, // end slots\r\n                }, // end table\r\n              ],\r\n            },\r\n            slots: {\r\n              title: 'Base District',\r\n            },\r\n          }, // end of badge-custom\r\n          {\r\n            type: 'horizontal-table',\r\n            options: {\r\n              topicKey: 'zoning',\r\n              id: 'zoningOverlay',\r\n              // limit: 100,\r\n              fields: [\r\n                {\r\n                  label: 'Name',\r\n                  value: function (state, item) {\r\n                    return item.overlay_name\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Code Section',\r\n                  value: function (state, item) {\r\n                    return \"<a target='_blank' href='\"+item.code_section_link+\"'>\"+item.code_section+\" <i class='fa fa-external-link'></i></a>\"\r\n                  }\r\n                },\r\n              ],\r\n            },\r\n            slots: {\r\n              title: 'Overlays',\r\n              items: function(state, item) {\r\n                // console.log('state.sources:', state.sources['zoningBase'].data.rows);\r\n                var id = item.properties.OBJECTID,\r\n                    target = state.sources.zoningOverlay.targets[id] || {},\r\n                    data = target.data || {};\r\n                // console.log('zoningbase target:', target);\r\n                return data.rows || [];\r\n              },\r\n            },\r\n          },\r\n          {\r\n            type: 'horizontal-table',\r\n            options: {\r\n              topicKey: 'zoning',\r\n              // shouldShowFilters: false,\r\n              id: 'baseZoning',\r\n              // defaultIncrement: 10,\r\n              // showAllRowsOnFirstClick: true,\r\n              // showOnlyIfData: true,\r\n              fields: [\r\n                {\r\n                  label: 'Bill Type',\r\n                  value: function (state, item) {\r\n                    return item.billType;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Current Zoning',\r\n                  value: function(state, item) {\r\n                    return item.currentZoning;\r\n                  },\r\n                },\r\n                {\r\n                  label: 'Pending Bill',\r\n                  value: function (state, item) {\r\n                    return `<a target=\"_blank\" href=\"${item.pendingbillurl}\">${item.pendingbill} <i class=\"fa fa-external-link\"></i></a>`;\r\n                  }\r\n                },\r\n              ], // end fields\r\n            },\r\n            slots: {\r\n              title: 'Pending Bills',\r\n              items: function(state, item) {\r\n                // console.log('state.sources:', state.sources['zoningBase'].data.rows);\r\n                var id = item.properties.OBJECTID,\r\n                    target = state.sources.zoningBase.targets[id] || {},\r\n                    data = target.data || {};\r\n\r\n                // include only rows where pending is true\r\n                const { rows=[] } = data;\r\n                const rowsFiltered = rows.filter(row => row.pending === 'Yes');\r\n\r\n                // give each pending zoning bill a type of \"zoning\"\r\n                const rowsFilteredWithType = rowsFiltered.map((row) => {\r\n                  row.billType = 'Base District';\r\n                  row.currentZoning = row.long_code;\r\n                  return row;\r\n                });\r\n\r\n                let overlayRowsFilteredWithType = [];\r\n\r\n                // append pending overlays\r\n                if (state.sources.zoningOverlay.targets[id]) {\r\n                  const overlayRows = state.sources.zoningOverlay.targets[id].data.rows;\r\n                  const overlayRowsFiltered = overlayRows.filter(row => row.pending === 'Yes');\r\n                  overlayRowsFilteredWithType = overlayRowsFiltered.map((row) => {\r\n                    row.billType = 'Overlay';\r\n                    row.currentZoning = row.overlay_name;\r\n                    return row;\r\n                  });\r\n                } else {\r\n                  overlayRowsFilteredWithType = [];\r\n                }\r\n\r\n                // combine pending zoning and overlays\r\n                const zoningAndOverlays = rowsFilteredWithType.concat(overlayRowsFilteredWithType);\r\n\r\n                return zoningAndOverlays;\r\n              },\r\n            }, // end slots\r\n          }, // end table\r\n        ], // end of tab-group components\r\n      },\r\n      slots: {\r\n        items: function (state) {\r\n          // return state.dorParcels.data;\r\n          return state.parcels.dor.data;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'zoning',\r\n        id: 'zoningAppeals',\r\n        // limit: 100,\r\n        fields: [\r\n          {\r\n            label: 'Processed Date',\r\n            value: function(state, item) {\r\n              return item.processeddate;\r\n            },\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'ID',\r\n            value: function(state, item){\r\n              //return item.appeal_key\r\n              // return \"<a target='_blank' href='//li.phila.gov/#details?entity=violationdetails&eid=\"+item.casenumber+\"&key=\"+item.addresskey+\"&address=\"+item.address+\"'>\"+item.casenumber+\" <i class='fa fa-external-link'></i></a>\"\r\n              return \"<a target='_blank' href='http://li.phila.gov/#details?entity=appeals&eid=\"+item.appeal_key+\"&key=\"+item.addresskey+\"&address=\"+item.address+\"'>\"+item.appealno+\"<i class='fa fa-external-link'></i></a>\"\r\n            }\r\n          },\r\n          {\r\n            label: 'Description',\r\n            value: function(state, item){\r\n              return item.appealgrounds;\r\n            }\r\n          },\r\n          {\r\n            label: 'Scheduled Date',\r\n            value: function(state, item) {\r\n              return item.date_scheduled;\r\n            },\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'Status',\r\n            value: function(state, item){\r\n              // return item.properties.CODE_SECTION\r\n              return item.decision\r\n            }\r\n          },\r\n        ],\r\n        sort: {\r\n          // this should return the val to sort on\r\n          getValue: function(item) {\r\n            return item.date_scheduled;\r\n          },\r\n          // asc or desc\r\n          order: 'desc'\r\n        },\r\n      },\r\n      slots: {\r\n        title : 'Appeals',\r\n        items: function(state) {\r\n          if (state.sources['zoningAppeals'].data) {\r\n            if (state.sources['zoningAppeals'].data.rows) {\r\n              var data = state.sources['zoningAppeals'].data.rows;\r\n              var rows = data.map(function(row){\r\n                var itemRow = row;\r\n                // var itemRow = Object.assign({}, row);\r\n                //itemRow.DISTANCE = 'TODO';\r\n                return itemRow;\r\n              });\r\n              return rows;\r\n            }\r\n          }\r\n        },\r\n      },\r\n    },\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: 'Looking for zoning documents? They are now located in the Licenses & Inspections tab under \"Zoning Permit Documents\".',\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'zoning',\r\n        id: 'rco',\r\n        // limit: 100,\r\n        fields: [\r\n          {\r\n            label: 'RCO',\r\n            value: function(state, item) {\r\n              return '<b>' + item.properties.ORGANIZATION_NAME + '</b><br>'\r\n              + item.properties.ORGANIZATION_ADDRESS\r\n            },\r\n          },\r\n          {\r\n            label: 'Meeting Address',\r\n            value: function(state, item) {\r\n              return item.properties.MEETING_LOCATION_ADDRESS\r\n            }\r\n          },\r\n          {\r\n            label: 'Primary Contact',\r\n            value: function(state, item) {\r\n              // return item.properties.PRIMARY_PHONE\r\n              return item.properties.PRIMARY_NAME + '<br>'\r\n              + item.properties.PRIMARY_PHONE + '<br>'\r\n              // + `<b><a :href=\"'mailto:' + item.properties.PRIMARY_EMAIL\">`\r\n              + item.properties.PRIMARY_EMAIL// + '</a></b>'\r\n            },\r\n            transforms: [\r\n              'rcoPrimaryContact'\r\n            ]\r\n          },\r\n          {\r\n            label: 'Preferred Method',\r\n            value: function(state, item){\r\n              return item.properties.PREFFERED_CONTACT_METHOD\r\n            }\r\n          },\r\n        ],\r\n        externalLink: {\r\n          forceShow: true,\r\n          action: function() {\r\n            return 'See a list of all RCOs in the city [PDF]';\r\n          },\r\n          name: '',\r\n          href: function(state) {\r\n            // var address = state.geocode.data.properties.street_address;\r\n            // var addressEncoded = encodeURIComponent(address);\r\n            return '//www.phila.gov/CityPlanning/projectreviews/RCO%20Related/List_of_RCOs.pdf';\r\n          }\r\n        }\r\n      },\r\n      slots: {\r\n        title: 'Registered Community Organizations',\r\n        items: function(state) {\r\n          if (state.sources['rco'].data) {\r\n            var data = state.sources['rco'].data;\r\n            var rows = data.map(function(row){\r\n              var itemRow = row;\r\n              // var itemRow = Object.assign({}, row);\r\n              return itemRow;\r\n            });\r\n            return rows;\r\n          }\r\n        },\r\n      },\r\n    },\r\n  ],\r\n  basemap: 'dor',\r\n  dynamicMapLayers: [\r\n    'zoning'\r\n  ],\r\n  identifyFeature: 'dor-parcel',\r\n  parcels: 'dor'\r\n}\r\n","export default {\r\n  key: '311',\r\n  icon: 'phone',\r\n  label: '311',\r\n  dataSources: ['threeOneOne'],\r\n  basemap: 'pwd',\r\n  identifyFeature: 'address-marker',\r\n  parcels: 'pwd',\r\n  components: [\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: 'A more detailed look at 311 service requests near your \\\r\n          search address. This includes sensitive information, such as \\\r\n          request descriptions and records marked private by the customer,\\\r\n          that cannot be shared with the public.\\\r\n        '\r\n      }\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: '311',\r\n        id: '311',\r\n        sort: {\r\n          select: true,\r\n          sortFields: [\r\n            'distance',\r\n            'date',\r\n          ],\r\n          getValue: function(item, sortField) {\r\n            var val;\r\n\r\n            if (sortField === 'date' || !sortField) {\r\n              val = item.properties.REQUESTED_DATETIME;\r\n            } else if (sortField === 'distance') {\r\n              val = item._distance;\r\n            }\r\n            return val;\r\n          },\r\n          order: function(sortField) {\r\n            var val;\r\n            if (sortField === 'date') {\r\n              val = 'desc';\r\n            } else {\r\n              val = 'asc';\r\n            }\r\n            return val;\r\n          },\r\n          order: function(sortField) {\r\n            var val;\r\n            if (sortField === 'date') {\r\n              val = 'desc';\r\n            } else {\r\n              val = 'asc';\r\n            }\r\n            return val;\r\n          },\r\n        },\r\n        filters: [\r\n          {\r\n            type: 'time',\r\n            getValue: function(item) {\r\n              return item.properties.REQUESTED_DATETIME;\r\n            },\r\n            label: 'From the last',\r\n            values: [\r\n              {\r\n                label: '30 days',\r\n                value: '30',\r\n                unit: 'days',\r\n                direction: 'subtract',\r\n              },\r\n              {\r\n                label: '90 days',\r\n                value: '90',\r\n                unit: 'days',\r\n                direction: 'subtract',\r\n              },\r\n              {\r\n                label: 'year',\r\n                value: '1',\r\n                unit: 'years',\r\n                direction: 'subtract',\r\n              }\r\n            ]\r\n          }\r\n        ],\r\n        filterByText: {\r\n          label: 'Filter by',\r\n          fields: [\r\n            'DESCRIPTION',\r\n            'SUBJECT',\r\n            'ADDRESS'\r\n          ]\r\n        },\r\n        mapOverlay: {\r\n          marker: 'circle',\r\n          style: {\r\n            radius: 6,\r\n            fillColor: '#ff3f3f',\r\n            color: '#ff0000',\r\n            weight: 1,\r\n            opacity: 1,\r\n            fillOpacity: 1.0\r\n          },\r\n          hoverStyle: {\r\n            radius: 6,\r\n            fillColor: 'yellow',\r\n            color: '#ff0000',\r\n            weight: 1,\r\n            opacity: 1,\r\n            fillOpacity: 1.0\r\n          }\r\n        },\r\n        fields: [\r\n          {\r\n            label: 'Date',\r\n            value: function(state, item) {\r\n              return item.properties.REQUESTED_DATETIME;\r\n            },\r\n            nullValue: 'no date available',\r\n            transforms: [\r\n              'date'\r\n            ]\r\n          },\r\n          {\r\n            label: 'Address',\r\n            value: function(state, item) {\r\n              return item.properties.ADDRESS;\r\n            }\r\n          },\r\n          {\r\n            label: 'Subject',\r\n            value: function(state, item) {\r\n              if (item.properties.MEDIA_URL) {\r\n                return '<a target=\"_blank\" href='+item.properties.MEDIA_URL+'>'+item.properties.SUBJECT+'</a>';\r\n              } else {\r\n                return item.properties.SUBJECT;\r\n              }\r\n            }\r\n          },\r\n          {\r\n            label: 'Description (not shared with the public)',\r\n            value: function(state, item) {\r\n              return item.properties.DESCRIPTION;\r\n            }\r\n          },\r\n          {\r\n            label: 'Distance',\r\n            value: function(state, item) {\r\n              // return `${item._distance} ft`;\r\n              return item._distance + ' ft';\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      slots: {\r\n        title: 'Nearby Service Requests',\r\n        data: 'threeOneOne',\r\n        items: function(state) {\r\n          var data = state.sources['threeOneOne'].data;\r\n          var rows = data.map(function(row){\r\n            var itemRow = row;\r\n            // var itemRow = Object.assign({}, row);\r\n            // itemRow.DISTANCE = 'TODO';\r\n            return itemRow;\r\n          });\r\n          return rows;\r\n        },\r\n      }\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n  key: 'stormwater',\r\n  icon: 'tint',\r\n  label: 'Stormwater',\r\n  dataSources: ['stormwater'],\r\n  basemap: 'pwd',\r\n  dynamicMapLayers: [\r\n    'stormwater'\r\n  ],\r\n  identifyFeature: 'pwd-parcel',\r\n  parcels: 'pwd',\r\n  components: [\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: 'Stormwater billing accounts associated with your search address. The property boundaries displayed on the map for reference only and may not be used in place of recorded deeds or land surveys. Boundaries are generalized for ease of visualization. Source: Philadelphia Water Department'\r\n      }\r\n    },\r\n    {\r\n      type: 'vertical-table',\r\n      options: {},\r\n      slots: {\r\n        title: 'Parcel',\r\n        fields: [\r\n          {\r\n            label: 'Parcel ID',\r\n            value: function(state) {\r\n              // return state.geocode.data.properties.pwd_parcel_id;\r\n              return state.sources.stormwater.data.Parcel.ParcelID;\r\n            }\r\n          },\r\n          {\r\n            label: 'Address',\r\n            value: function(state) {\r\n              return state.sources.stormwater.data.Parcel.Address;\r\n            }\r\n          },\r\n          {\r\n            label: 'Building Type',\r\n            value: function(state) {\r\n              return state.sources.stormwater.data.Parcel.BldgType;\r\n            }\r\n          },\r\n          {\r\n            label: 'Gross Area',\r\n            value: function(state) {\r\n              return state.sources.stormwater.data.Parcel.GrossArea + ' sq ft';\r\n            },\r\n            transforms: [\r\n              'thousandsPlace'\r\n            ]\r\n          },\r\n          {\r\n            label: 'Impervious Area',\r\n            value: function(state) {\r\n              return state.sources.stormwater.data.Parcel.ImpervArea + ' sq ft';\r\n            },\r\n            transforms: [\r\n              'thousandsPlace'\r\n            ]\r\n          },\r\n          {\r\n            label: 'CAP Eligible',\r\n            value: function(state) {\r\n              return state.sources.stormwater.data.Parcel.CAPEligible;\r\n            },\r\n            transforms: [\r\n              'booleanToYesNo'\r\n            ]\r\n          },\r\n        ]\r\n      },\r\n    },\r\n    {\r\n      type: 'horizontal-table',\r\n      options: {\r\n        topicKey: 'water',\r\n        id: 'stormwater',\r\n        // limit: 100,\r\n        // TODO this isn't used yet, but should be for highlighting rows/\r\n        // map features.\r\n        // overlay: '311',\r\n        fields: [\r\n          {\r\n            label: 'Account #',\r\n            value: function(state, item) {\r\n              return item.AccountNumber;\r\n            }\r\n          },\r\n          {\r\n            label: 'Customer',\r\n            value: function(state, item) {\r\n              return item.CustomerName;\r\n            }\r\n          },\r\n          {\r\n            label: 'Status',\r\n            value: function(state, item) {\r\n              return item.AcctStatus;\r\n            }\r\n          },\r\n          {\r\n            label: 'Service Type',\r\n            value: function(state, item) {\r\n              return item.ServiceTypeLabel;\r\n            }\r\n          },\r\n          {\r\n            label: 'Size',\r\n            value: function(state, item) {\r\n              return item.MeterSize;\r\n            }\r\n          },\r\n          {\r\n            label: 'Stormwater',\r\n            value: function(state, item) {\r\n              return item.StormwaterStatus;\r\n            }\r\n          }\r\n        ],\r\n        externalLink: {\r\n          forceShow: true,\r\n          action: function(count) {\r\n            return 'See more at Stormwater Billing';\r\n          },\r\n          name: 'Stormwater Billing',\r\n          href: function(state) {\r\n            var id = state.sources.stormwater.data.Parcel.ParcelID;\r\n            return '//www.phila.gov/water/swmap/Parcel.aspx?parcel_id=' + id;\r\n          }\r\n        }\r\n      },\r\n      slots: {\r\n        title: 'Accounts',\r\n        items: function(state) {\r\n          var data = state.sources['stormwater'].data\r\n          var rows = data.Accounts.map(function(row){\r\n            var itemRow = row;\r\n            // var itemRow = Object.assign({}, row);\r\n            return itemRow;\r\n          });\r\n          return rows;\r\n        }\r\n      }\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n  key: 'nearby',\r\n  icon: 'map-marker-alt',\r\n  label: 'Nearby',\r\n  dataSources: ['threeOneOneCarto', 'crimeIncidents', 'nearbyZoningAppeals'],\r\n  // dataSources: ['311Carto', 'crimeIncidents', 'nearbyZoningAppeals', 'vacantIndicatorsPoints'],\r\n  // dataSources: ['vacantLand', 'vacantBuilding', '311Carto', 'crimeIncidents', 'nearbyZoningAppeals'],\r\n  basemap: 'pwd',\r\n  // featureLayers: [\r\n  //   'vacantLand',\r\n  //   'vacantBuilding'\r\n  // ],\r\n  identifyFeature: 'address-marker',\r\n  parcels: 'pwd',\r\n  // TODO implement this\r\n  // computed: {\r\n  //   label(state) {\r\n  //     var land = state.sources.vacantLand.data\r\n  //     var building = state.sources.vacantBuilding.data\r\n  //     if (land.length === 0 && building.length === 0) {\r\n  //       return 'Not Likely Vacant';\r\n  //     } else if (land.length > 0) {\r\n  //       return 'Likely Vacant Land';\r\n  //     } else if (building.length > 0) {\r\n  //       return 'Likely Vacant Building';\r\n  //     }\r\n  //   }\r\n  // },\r\n  components: [\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: '\\\r\n          See recent activity near your search address including 311 \\\r\n          service requests, crimes, zoning appeals, and more. Hover over a\\\r\n          record below to highlight it on the map.\\\r\n        '\r\n      }\r\n    },\r\n    // {\r\n    //   type: 'badge',\r\n    //   options: {\r\n    //     titleBackground: function(state) {\r\n    //       var text = getVacancyText(state);\r\n    //       if (text.includes('Land')) {\r\n    //         return 'orange';\r\n    //       } else if (text.includes('Building')) {\r\n    //         return 'purple';\r\n    //       } else {\r\n    //         return '#58c04d';\r\n    //       }\r\n    //     }\r\n    //   },\r\n    //   slots: {\r\n    //     title: 'Vacancy',\r\n    //     value: function(state) {\r\n    //       return getVacancyText(state);\r\n    //     },\r\n    //     // description: function(state) {\r\n    //     //   var code = state.geocode.data.properties.zoning;\r\n    //     //   return ZONING_CODE_MAP[code];\r\n    //     // },\r\n    //   }\r\n    // },\r\n    {\r\n      type: 'horizontal-table-group',\r\n      options: {\r\n        filters: [\r\n          {\r\n            type: 'data',\r\n            getValue: function(item) {\r\n              return item;\r\n            },\r\n            label: 'What nearby activity would you like to see?',\r\n            values: [\r\n              {\r\n                label: '311 Requests',\r\n                value: '311',\r\n              },\r\n              {\r\n                label: 'Crime Incidents',\r\n                value: 'crimeIncidents',\r\n              },\r\n              {\r\n                label: 'Zoning Appeals',\r\n                value: 'nearbyZoningAppeals',\r\n              },\r\n              {\r\n                label: 'Vacant Properties',\r\n                value: 'vacantIndicatorsPoints',\r\n              }\r\n            ]\r\n          },\r\n        ],\r\n        // components for the content pane.\r\n        tables: [\r\n          {\r\n            type: 'horizontal-table',\r\n            options: {\r\n              id: '311',\r\n              sort: {\r\n                select: true,\r\n                sortFields: [\r\n                  'distance',\r\n                  'date',\r\n                ],\r\n                getValue: function(item, sortField) {\r\n                  var val;\r\n                  if (sortField === 'date' || !sortField) {\r\n                    val = item.requested_datetime;\r\n                  } else if (sortField === 'distance') {\r\n                    val = item.distance;\r\n                  }\r\n                  return val;\r\n                },\r\n                order: function(sortField) {\r\n                  var val;\r\n                  if (sortField === 'date') {\r\n                    val = 'desc';\r\n                  } else {\r\n                    val = 'asc';\r\n                  }\r\n                  return val;\r\n                }\r\n              },\r\n              filters: [\r\n                {\r\n                  type: 'time',\r\n                  getValue: function(item) {\r\n                    return item.requested_datetime;\r\n                  },\r\n                  label: 'From the last',\r\n                  values: [\r\n                    {\r\n                      label: '30 days',\r\n                      value: '30',\r\n                      unit: 'days',\r\n                      direction: 'subtract',\r\n                    },\r\n                    {\r\n                      label: '90 days',\r\n                      value: '90',\r\n                      unit: 'days',\r\n                      direction: 'subtract',\r\n                    },\r\n                    {\r\n                      label: 'year',\r\n                      value: '1',\r\n                      unit: 'years',\r\n                      direction: 'subtract',\r\n                    }\r\n                  ]\r\n                }\r\n              ],\r\n              filterByText: {\r\n                label: 'Filter by text',\r\n                fields: [\r\n                  'service_name',\r\n                  'address'\r\n                ]\r\n              },\r\n              mapOverlay: {\r\n                marker: 'circle',\r\n                style: {\r\n                  radius: 6,\r\n                  fillColor: '#ff3f3f',\r\n                  color: '#ff0000',\r\n                  weight: 1,\r\n                  opacity: 1,\r\n                  fillOpacity: 1.0\r\n                },\r\n                hoverStyle: {\r\n                  radius: 6,\r\n                  fillColor: 'yellow',\r\n                  color: '#ff0000',\r\n                  weight: 1,\r\n                  opacity: 1,\r\n                  fillOpacity: 1.0\r\n                }\r\n              },\r\n              fields: [\r\n                {\r\n                  label: 'Date',\r\n                  value: function(state, item) {\r\n                    return item.requested_datetime;\r\n                  },\r\n                  nullValue: 'no date available',\r\n                  transforms: [\r\n                    'date'\r\n                  ]\r\n                },\r\n                {\r\n                  label: 'Address',\r\n                  value: function(state, item) {\r\n                    return item.address;\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Subject',\r\n                  value: function(state, item) {\r\n                    if (item.media_url) {\r\n                      return '<a target=\"_blank\" href='+item.media_url+'>'+item.service_name+'</a>';\r\n                    } else {\r\n                      return item.service_name;\r\n                    }\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Distance',\r\n                  value: function(state, item) {\r\n                    return parseInt(item.distance) + ' ft';\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            slots: {\r\n              title: 'Nearby Service Requests',\r\n              data: 'threeOneOneCarto',\r\n              items: function(state) {\r\n                var data = state.sources['threeOneOneCarto'].data || [];\r\n                var rows = data.map(function(row){\r\n                  var itemRow = row;\r\n                  // var itemRow = Object.assign({}, row);\r\n                  return itemRow;\r\n                });\r\n                return rows;\r\n              },\r\n            }\r\n          },\r\n          {\r\n            type: 'horizontal-table',\r\n            options: {\r\n              id: 'crimeIncidents',\r\n              sort: {\r\n                select: true,\r\n                sortFields: [\r\n                  'distance',\r\n                  'date',\r\n                ],\r\n                getValue: function(item, sortField) {\r\n                  var val;\r\n                  if (sortField === 'date' || !sortField) {\r\n                    val = item.dispatch_date;\r\n                  } else if (sortField === 'distance') {\r\n                    val = item.distance;\r\n                  }\r\n                  return val;\r\n                },\r\n                order: function(sortField) {\r\n                  var val;\r\n                  if (sortField === 'date') {\r\n                    val = 'desc';\r\n                  } else {\r\n                    val = 'asc';\r\n                  }\r\n                  return val;\r\n                },\r\n              },\r\n              filters: [\r\n                {\r\n                  type: 'time',\r\n                  getValue: function(item) {\r\n                    return item.dispatch_date;\r\n                  },\r\n                  label: 'From the last',\r\n                  values: [\r\n                    {\r\n                      label: '30 days',\r\n                      value: '30',\r\n                      unit: 'days',\r\n                      direction: 'subtract',\r\n                    },\r\n                    {\r\n                      label: '90 days',\r\n                      value: '90',\r\n                      unit: 'days',\r\n                      direction: 'subtract',\r\n                    },\r\n                  ]\r\n                }\r\n              ],\r\n              filterByText: {\r\n                label: 'Filter by',\r\n                fields: [\r\n                  'text_general_code',\r\n                ]\r\n              },\r\n              mapOverlay: {\r\n                marker: 'circle',\r\n                style: {\r\n                  radius: 6,\r\n                  fillColor: '#6674df',\r\n                  color: '#6674df',\r\n                  weight: 1,\r\n                  opacity: 1,\r\n                  fillOpacity: 1.0\r\n                },\r\n                hoverStyle: {\r\n                  radius: 6,\r\n                  fillColor: 'yellow',\r\n                  color: '#6674df',\r\n                  weight: 1,\r\n                  opacity: 1,\r\n                  fillOpacity: 1.0\r\n                }\r\n              },\r\n              fields: [\r\n                {\r\n                  label: 'Date',\r\n                  value: function(state, item) {\r\n                    return item.dispatch_date;\r\n                  },\r\n                  nullValue: 'no date available',\r\n                  transforms: [\r\n                    'date'\r\n                  ]\r\n                },\r\n                {\r\n                  label: 'Location',\r\n                  value: function(state, item) {\r\n                    return item.location_block;\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Description',\r\n                  value: function(state, item) {\r\n                    return item.text_general_code;\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Distance',\r\n                  value: function(state, item) {\r\n                    return parseInt(item.distance) + ' ft';\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            slots: {\r\n              title: 'Crime Incidents',\r\n              data: 'crimeIncidents',\r\n              items: function(state) {\r\n                var data = state.sources['crimeIncidents'].data || [];\r\n                var rows = data.map(function(row){\r\n                  var itemRow = row;\r\n                  // var itemRow = Object.assign({}, row);\r\n                  return itemRow;\r\n                });\r\n                return rows;\r\n              },\r\n            } // end of slots\r\n          }, // end of horizontal-table\r\n          {\r\n            type: 'horizontal-table',\r\n            options: {\r\n              id: 'nearbyZoningAppeals',\r\n              sort: {\r\n                select: true,\r\n                sortFields: [\r\n                  'distance',\r\n                  'date',\r\n                ],\r\n                getValue: function(item, sortField) {\r\n                  var val;\r\n                  if (sortField === 'date' || !sortField) {\r\n                    val = item.decisiondate;\r\n                  } else if (sortField === 'distance') {\r\n                    val = item.distance;\r\n                  }\r\n                  return val;\r\n                },\r\n                order: function(sortField) {\r\n                  var val;\r\n                  if (sortField === 'date') {\r\n                    val = 'desc';\r\n                  } else {\r\n                    val = 'asc';\r\n                  }\r\n                  return val;\r\n                },\r\n              },\r\n              filterByText: {\r\n                label: 'Filter by',\r\n                fields: [\r\n                  'appealgrounds'\r\n                ]\r\n              },\r\n              mapOverlay: {\r\n                marker: 'circle',\r\n                style: {\r\n                  radius: 6,\r\n                  fillColor: '#009900',\r\n                  color: '#009900',\r\n                  weight: 1,\r\n                  opacity: 1,\r\n                  fillOpacity: 1.0\r\n                },\r\n                hoverStyle: {\r\n                  radius: 6,\r\n                  fillColor: 'yellow',\r\n                  color: '#009900',\r\n                  weight: 1,\r\n                  opacity: 1,\r\n                  fillOpacity: 1.0\r\n                }\r\n              },\r\n              fields: [\r\n                {\r\n                  label: 'Date',\r\n                  value: function(state, item) {\r\n                    return item.decisiondate;\r\n                  },\r\n                  nullValue: 'no date available',\r\n                  transforms: [\r\n                    'date'\r\n                  ]\r\n                },\r\n                {\r\n                  label: 'Location',\r\n                  value: function(state, item) {\r\n                    return item.address;\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Description',\r\n                  value: function(state, item) {\r\n                    return item.appealgrounds;\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Distance',\r\n                  value: function(state, item) {\r\n                    return parseInt(item.distance) + ' ft';\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            slots: {\r\n              title: 'Zoning Appeals',\r\n              data: 'nearbyZoningAppeals',\r\n              items: function(state) {\r\n                var data = state.sources['nearbyZoningAppeals'].data || [];\r\n                var rows = data.map(function(row){\r\n                  var itemRow = row;\r\n                  // var itemRow = Object.assign({}, row);\r\n                  return itemRow;\r\n                });\r\n                return rows;\r\n              },\r\n            } // end of slots\r\n          }, // end of horizontal-table\r\n          {\r\n            type: 'horizontal-table',\r\n            options: {\r\n              id: 'vacantIndicatorsPoints',\r\n              sort: {\r\n                select: true,\r\n                sortFields: [\r\n                  'distance',\r\n                  'type',\r\n                ],\r\n                getValue: function(item, sortField) {\r\n                  var val;\r\n                  if (sortField === 'type' || !sortField) {\r\n                    val = item.properties.VACANT_FLAG;\r\n                  } else if (sortField === 'distance') {\r\n                    val = item._distance;\r\n                  }\r\n                  return val;\r\n                }\r\n              },\r\n              filterByText: {\r\n                label: 'Filter by',\r\n                fields: [\r\n                  'ADDRESS',\r\n                  'VACANT_FLAG'\r\n                ]\r\n              },\r\n              mapOverlay: {\r\n                marker: 'circle',\r\n                style: {\r\n                  radius: 6,\r\n                  fillColor: '#9400c6',\r\n                  color: '#9400c6',\r\n                  weight: 1,\r\n                  opacity: 1,\r\n                  fillOpacity: 1.0\r\n                },\r\n                hoverStyle: {\r\n                  radius: 6,\r\n                  fillColor: 'yellow',\r\n                  color: '#009900',\r\n                  weight: 1,\r\n                  opacity: 1,\r\n                  fillOpacity: 1.0\r\n                }\r\n              },\r\n              fields: [\r\n                {\r\n                  label: 'Address',\r\n                  value: function(state, item) {\r\n                    return item.properties.ADDRESS;\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Property Type',\r\n                  value: function(state, item) {\r\n                    return item.properties.VACANT_FLAG;\r\n                  }\r\n                },\r\n                {\r\n                  label: 'Distance',\r\n                  value: function(state, item) {\r\n                    return item._distance + ' ft';\r\n                  }\r\n                },\r\n              ],\r\n              externalLink: {\r\n                forceShow: true,\r\n                action: function(count) {\r\n                  return 'See more at Vacancy Property Viewer';\r\n                },\r\n                name: 'Vacancy Property Viewer',\r\n                href: function(state) {\r\n                  // var address = state.geocode.data.properties.street_address;\r\n                  // var addressEncoded = encodeURIComponent(address);\r\n                  return '//phl.maps.arcgis.com/apps/webappviewer/index.html?id=64ac160773d04952bc17ad895cc00680';\r\n                }\r\n              }\r\n            },\r\n            slots: {\r\n              title: 'Likely Vacant Properties',\r\n              data: 'vacantIndicatorsPoints',\r\n              items: function(state) {\r\n                var data = state.sources['vacantIndicatorsPoints'].data || [];\r\n                var rows = data.map(function(row){\r\n                  var itemRow = row;\r\n                  // var itemRow = Object.assign({}, row);\r\n                  return itemRow;\r\n                });\r\n                return rows;\r\n              },\r\n            } // end of slots\r\n          }, // end of horizontal-table\r\n        ], // end comps\r\n      }, // end options\r\n      slots: {\r\n        // REVIEW should this go in options? maybe not, since it should be\r\n        // reactive.\r\n        items: function(state) {\r\n          // return state.pwdParcel;\r\n          return state.parcel.pwd\r\n        }\r\n      },\r\n    }\r\n  ]\r\n}\r\n","export default {\r\n  key: 'districts',\r\n  icon: 'clone',\r\n  label: 'Districts',\r\n  dataSources: ['opa'],\r\n  // REVIEW can these be calculated from vue deps?\r\n  components: [\r\n\r\n    {\r\n      type: 'callout',\r\n      slots: {\r\n        text: '\\\r\n          Districts related to police, L&I, city planning, streets, \\\r\n          census, and commerce for this address. Sources: Department \\\r\n          of Streets, Licenses and Inspections, Planning and Development,\\\r\n          & Philadelphia Police Dept.\\\r\n        ',\r\n      }\r\n    },\r\n    {\r\n      type: 'vertical-table',\r\n      slots: {\r\n        title: \"Districts\",\r\n        fields: [\r\n          {\r\n            label: 'Planning',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.planning_district;\r\n            }\r\n          },\r\n          {\r\n            label: 'L+I',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.li_district;\r\n            }\r\n          },\r\n          {\r\n            label: 'Census Tract (2010)',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.census_tract_2010;\r\n            }\r\n          },\r\n          {\r\n            label: 'Census Block Group (2010)',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.census_block_group_2010;\r\n            }\r\n          },\r\n          {\r\n            label: 'Commercial Corridor',\r\n            value: function(state) {\r\n              if(state.geocode.data.properties.commercial_corridor.length > 0) {\r\n                return state.geocode.data.properties.commercial_corridor;\r\n              } else {\r\n                return \"n/a\"\r\n              }\r\n            }\r\n          },\r\n        ],\r\n      },\r\n      options: {\r\n      }\r\n    },\r\n    {\r\n      type: 'vertical-table',\r\n      slots: {\r\n        title: \"Public Safety\",\r\n        fields: [\r\n          {\r\n            label: 'Police District',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.police_district;\r\n            }\r\n          },\r\n          {\r\n            label: 'Police Public Service Area',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.police_service_area;\r\n            }\r\n          },\r\n          {\r\n            label: 'Police Division',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.political_division;\r\n            }\r\n          },\r\n        ],\r\n      },\r\n      options: {\r\n      }\r\n    },\r\n    {\r\n      type: 'vertical-table',\r\n      slots: {\r\n        title: \"Streets\",\r\n        fields: [\r\n          {\r\n            label: 'Highway District',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.highway_district;\r\n            }\r\n          },\r\n          {\r\n            label: 'Highway Section',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.highway_section;\r\n            }\r\n          },\r\n          {\r\n            label: 'Highway Subsection',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.highway_subsection;\r\n            }\r\n          },\r\n          {\r\n            label: 'Street Light Routes',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.street_light_route;\r\n            }\r\n          },\r\n          {\r\n            label: 'Traffic District',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.traffic_district;\r\n            }\r\n          },\r\n          {\r\n            label: 'Traffic PM District',\r\n            value: function(state) {\r\n              return state.geocode.data.properties.traffic_pm_district;\r\n            }\r\n          },\r\n        ],\r\n      },\r\n      options: {}\r\n    },\r\n    {\r\n      type: 'external-link',\r\n      options:{\r\n        data: 'See more districts in OpenMaps',\r\n        href: function() {\r\n          return '//openmaps.phila.gov/';\r\n        }\r\n      }\r\n    }\r\n  ],\r\n  basemap: 'pwd',\r\n  identifyFeature: 'address-marker',\r\n  parcels: 'pwd',\r\n}\r\n","/*\r\n_________ .__  __            _____   __  .__\r\n\\_   ___ \\|__|/  |_ ___.__. /  _  \\_/  |_|  | _____    ______\r\n/    \\  \\/|  \\   __<   |  |/  /_\\  \\   __\\  | \\__  \\  /  ___/\r\n\\     \\___|  ||  |  \\___  /    |    \\  | |  |__/ __ \\_\\___ \\\r\n \\______  /__||__|  / ____\\____|__  /__| |____(____  /____  >\r\n        \\/          \\/            \\/               \\/     \\/\r\n*/\r\n\r\n// import * as Sentry from '@sentry/browser';\r\n// Sentry.init({ dsn: 'https://bbd37729e48142faaefba93ff32e3c14@sentry.io/1331835' });\r\n\r\n// Font Awesome Icons\r\nimport { library } from '@fortawesome/fontawesome-svg-core'\r\nimport { faHome } from '@fortawesome/pro-solid-svg-icons/faHome';\r\nimport { faBook } from '@fortawesome/pro-solid-svg-icons/faBook';\r\nimport { faWrench } from '@fortawesome/pro-solid-svg-icons/faWrench';\r\nimport { faUniversity } from '@fortawesome/pro-solid-svg-icons/faUniversity';\r\nimport { faGavel } from '@fortawesome/pro-solid-svg-icons/faGavel';\r\nimport { faMapMarkerAlt } from '@fortawesome/pro-solid-svg-icons/faMapMarkerAlt';\r\nimport { faLandmark } from '@fortawesome/pro-solid-svg-icons/faLandmark';\r\nimport { faBuilding } from '@fortawesome/pro-solid-svg-icons/faBuilding';\r\nimport { faPhone } from '@fortawesome/pro-solid-svg-icons/faPhone';\r\nimport { faTint } from '@fortawesome/pro-solid-svg-icons/faTint';\r\nimport { faClone } from '@fortawesome/pro-solid-svg-icons/faClone';\r\nlibrary.add(faHome, faBook, faWrench, faUniversity, faGavel, faMapMarkerAlt, faLandmark, faBuilding, faPhone, faTint, faClone);\r\n\r\nimport accounting from 'accounting';\r\nimport axios from 'axios';\r\nimport moment from 'moment';\r\nimport mapboard from '@cityofphiladelphia/mapboard';\r\n\r\n// General Config Modules\r\nimport helpers from './util/helpers';\r\nimport map from './general/map';\r\nimport transforms from './general/transforms';\r\nimport parcels from './general/parcels';\r\nimport legendControls from './general/legendControls';\r\nimport imageOverlayGroups from './general/imageOverlayGroups';\r\nimport greeting from './general/greeting';\r\n\r\n// data sources\r\nimport threeOneOne from './data-sources/311';\r\nimport threeOneOneCarto from './data-sources/311-carto';\r\nimport assessmentHist from './data-sources/assessment-history';\r\nimport condoList from './data-sources/condo-list';\r\nimport crimeIncidents from './data-sources/crime-incidents';\r\nimport dorCondoList from './data-sources/dor-condo-list';\r\nimport dorDocuments from './data-sources/dor-documents';\r\nimport liBusinessLicenses from './data-sources/li-business-licenses';\r\nimport liInspections from './data-sources/li-inspections';\r\nimport liPermits from './data-sources/li-permits';\r\nimport liPermitsAdditional from './data-sources/li-permits-additional';\r\nimport liViolations from './data-sources/li-violations';\r\nimport nearbyZoningAppeals from './data-sources/nearby-zoning-appeals';\r\nimport opa from './data-sources/opa';\r\nimport rco from './data-sources/rco';\r\nimport regmaps from './data-sources/regmaps';\r\nimport sanitationCenters from './data-sources/sanitation-centers';\r\nimport streetClosures from './data-sources/street-closures';\r\nimport stormwater from './data-sources/stormwater';\r\nimport vacantBuilding from './data-sources/vacant-building';\r\nimport vacantIndicatorsPoints from './data-sources/vacant-indicator-points';\r\nimport vacantLand from './data-sources/vacant-land';\r\nimport zoningAppeals from './data-sources/zoning-appeals';\r\nimport zoningBase from './data-sources/zoning-base';\r\nimport zoningDocs from './data-sources/zoning-docs';\r\nimport zoningOverlay from './data-sources/zoning-overlay';\r\n\r\n// Topics\r\nimport property from './topics/property';\r\nimport condos from './topics/condos';\r\nimport deeds from './topics/deeds';\r\nimport li from './topics/li';\r\nimport zoning from './topics/zoning';\r\nimport threeOneOneTopic from './topics/311';\r\nimport stormwaterTopic from './topics/stormwater';\r\nimport nearby from './topics/nearby';\r\nimport districts from './topics/districts';\r\n\r\n// styles\r\n// TODO move all styles here (that have a npm package)\r\nimport 'leaflet/dist/leaflet.css';\r\nimport 'leaflet-easybutton/src/easy-button.css';\r\nimport 'leaflet-measure/dist/leaflet-measure.css';\r\n\r\n// turn off console logging in production\r\n// TODO come up with better way of doing this with webpack + env vars\r\nconst { hostname='' } = location;\r\nif (hostname !== 'localhost' && !hostname.match(/(\\d+\\.){3}\\d+/)) {\r\n  console.log = console.info = console.debug = console.error = function () {};\r\n}\r\n\r\nvar BASE_CONFIG_URL = 'https://cdn.jsdelivr.net/gh/ajrothwell/mapboard-base-config@d18a86feb27b7e7c4496ed422ce30b5d80e64c1b/config.js';\r\n\r\n// configure accounting.js\r\naccounting.settings.currency.precision = 0;\r\n\r\nmapboard({\r\n  // DEV\r\n  // defaultAddress: '1234 MARKET ST',\r\n  panels: [\r\n    'topics',\r\n    'map'\r\n  ],\r\n  router: {\r\n    enabled: true\r\n  },\r\n  defaultAddressTextPlaceholder: {\r\n    // text: \"Search Address or 9-digit OPA Property Number\",\r\n    wideStyle: {\r\n      'max-width': '100%',\r\n      'font-size': '24px',\r\n      'line-height': '28px'\r\n    },\r\n    narrowStyle: {\r\n      'max-width': '100%',\r\n      'font-size': '20px',\r\n      'line-height': '24px'\r\n    }\r\n  },\r\n  geolocation: {\r\n    enabled: false\r\n  },\r\n  addressInput: {\r\n    width: 415,\r\n    mapWidth: 300,\r\n    position: 'right',\r\n    autocompleteEnabled: false,\r\n    autocompleteMax: 15,\r\n    placeholder: 'Search the map',\r\n  },\r\n  rootStyle: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    left: 0,\r\n    right: 0,\r\n  },\r\n  gatekeeperKey: helpers.GATEKEEPER_KEY,\r\n  map,\r\n  baseConfig: BASE_CONFIG_URL,\r\n  parcels,\r\n  imageOverlayGroups,\r\n  legendControls,\r\n  cyclomedia: {\r\n    enabled: true,\r\n    measurementAllowed: true,\r\n    popoutAble: true,\r\n  },\r\n  pictometry: {\r\n    enabled: true,\r\n  },\r\n  transforms,\r\n  greeting,\r\n  dataSources: {\r\n    threeOneOne,\r\n    threeOneOneCarto,\r\n    assessmentHist,\r\n    condoList,\r\n    crimeIncidents,\r\n    dorCondoList,\r\n    dorDocuments,\r\n    liBusinessLicenses,\r\n    liInspections,\r\n    liPermits,\r\n    liPermitsAdditional,\r\n    liViolations,\r\n    nearbyZoningAppeals,\r\n    opa,\r\n    rco,\r\n    regmaps,\r\n    sanitationCenters,\r\n    streetClosures,\r\n    stormwater,\r\n    vacantBuilding,\r\n    vacantIndicatorsPoints,\r\n    vacantLand,\r\n    zoningAppeals,\r\n    zoningBase,\r\n    zoningDocs,\r\n    zoningOverlay,\r\n  },\r\n  topics: [\r\n    property,\r\n    condos,\r\n    deeds,\r\n    li,\r\n    zoning,\r\n    threeOneOneTopic,\r\n    stormwaterTopic,\r\n    nearby,\r\n    districts,\r\n  ],\r\n  components: [\r\n    {\r\n      type: 'topic-set',\r\n      options: {\r\n        defaultTopic: 'property'\r\n      }\r\n    },\r\n  ],\r\n  // components: [\r\n  //   {\r\n  //     type: 'topic-set',\r\n  //     options: {\r\n  //       defaultTopic: 'property'\r\n  //     }\r\n  //   },\r\n  // ],\r\n});\r\n","var map = {\n\t\"./en-au\": 122,\n\t\"./en-au.js\": 122,\n\t\"./en-ca\": 121,\n\t\"./en-ca.js\": 121,\n\t\"./en-gb\": 120,\n\t\"./en-gb.js\": 120,\n\t\"./en-ie\": 119,\n\t\"./en-ie.js\": 119,\n\t\"./en-il\": 118,\n\t\"./en-il.js\": 118,\n\t\"./en-nz\": 117,\n\t\"./en-nz.js\": 117\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\tvar module = __webpack_require__(id);\n\treturn module;\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error('Cannot find module \"' + req + '\".');\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 356;","exports = module.exports = require(\"../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".greeting > h2 {\\r\\n  margin-bottom: 30px;\\r\\n}\\r\\n\\r\\n.greeting > .callout {\\r\\n  border-color: #58c04d;\\r\\n  background: #fff;\\r\\n  /*margin: 0 0 1rem 0;*/\\r\\n  padding: 1rem;\\r\\n}\\r\\n\\r\\n.greeting > .callout > ul {\\r\\n  margin: 0 0 0 1.42857rem;\\r\\n  padding: 0 0 0 1.42857rem;\\r\\n}\\r\\n\\r\\n#application .site-header, #application .app-footer {\\r\\n\\tbackground: #2176d2;\\r\\n}\\r\\n\\r\\n#application .site-header .page-title-container h1 {\\r\\n\\tfont-size: 2.14286rem;\\r\\n}\\r\\n\\r\\n/*this fixes an issue with the topic panel scrolling over the footer padding*/\\r\\n#application .app-footer {\\r\\n\\tposition: relative;\\r\\n}\\r\\n\\r\\n/*small*/\\r\\n@media screen and (max-width: 39.9375em) {\\r\\n\\t.logo {\\r\\n\\t\\tfloat: left;\\r\\n\\t}\\r\\n\\r\\n\\t.page-title-container {\\r\\n\\t\\tfloat: right;\\r\\n\\t}\\r\\n}\\r\\n\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../node_modules/css-loader/index.js!./styles.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/css-loader/index.js!./styles.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/css-loader/index.js!./styles.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","export default {\r\n  // possibly should move to base config\r\n  defaultBasemap: 'pwd',\r\n  defaultIdentifyFeature: 'address-marker',\r\n  imagery: {\r\n    enabled: true\r\n  },\r\n  initialImagery: 'imagery2018',\r\n}\r\n","export default {\r\n  pwd: {\r\n    multipleAllowed: false,\r\n    geocodeFailAttemptParcel: null,\r\n    clearStateOnError: false,\r\n    wipeOutOtherParcelsOnReverseGeocodeOnly: true,\r\n    geocodeField: 'PARCELID',\r\n    parcelIdInGeocoder: 'pwd_parcel_id',\r\n    getByLatLngIfIdFails: false\r\n  },\r\n  dor: {\r\n    multipleAllowed: true,\r\n    geocodeFailAttemptParcel: 'pwd',\r\n    clearStateOnError: true,\r\n    wipeOutOtherParcelsOnReverseGeocodeOnly: false,\r\n    geocodeField: 'MAPREG',\r\n    parcelIdInGeocoder: 'dor_parcel_id',\r\n    getByLatLngIfIdFails: true\r\n  },\r\n}\r\n","export default {\r\n  regmaps: {\r\n    items: function(state) {\r\n      // console.log('main.js imageOverlayGroups', state)\r\n      return state.sources.regmaps.data;\r\n    }\r\n  },\r\n}\r\n","export default {\r\n  stormwater: {\r\n    options: {\r\n      topics: ['stormwater'],\r\n      showWithBaseMapOnly: false\r\n    },\r\n    data: {\r\n      'Roof': {\r\n        'background-color': '#FEFF7F',\r\n      },\r\n      'Other Impervious Surface': {\r\n        'background-color': '#F2DCFF',\r\n      }\r\n    }\r\n  },\r\n  deeds: {\r\n    options: {\r\n      topics: ['deeds', 'zoning'],\r\n      showWithBaseMapOnly: true\r\n    },\r\n    data: {\r\n      'Easements': {\r\n        'border-color': 'rgb(255, 0, 197)',\r\n        'border-style': 'solid',\r\n        'border-weight': '1px',\r\n        'width': '12px',\r\n        'height': '12px',\r\n        'font-size': '10px',\r\n      },\r\n      'Trans Parcels': {\r\n        'border-color': 'rgb(0, 168, 132)',\r\n        'border-style': 'solid',\r\n        'border-weight': '1px',\r\n        'width': '12px',\r\n        'height': '12px',\r\n        'font-size': '10px',\r\n      },\r\n      'Rights of Way': {\r\n        'border-color': 'rgb(249, 147, 0)',\r\n        'border-style': 'solid',\r\n        'border-weight': '1px',\r\n        'width': '12px',\r\n        'height': '12px',\r\n        'font-size': '10px',\r\n      }\r\n    }\r\n  },\r\n}\r\n","export default {\r\n  message: '\\\r\n    <h2>CityAtlas connects you with information about any address in the city.</h2>\\\r\n    <p>Here are some things you can do with CityAtlas:</p>\\\r\n    <div class=\"callout\">\\\r\n      <ul>\\\r\n        <li>Research real estate information including property values, zoning, and document archives</li>\\\r\n        <li>Get the history of permits, licenses, and inspections at any address</li>\\\r\n        <li>Easily access high-resolution street-level and aerial imagery</li>\\\r\n        <li>View activity around an address, including vacancy, crime, 311 service requests, and more</li>\\\r\n        <li>Explore historical imagery and maps</li>\\\r\n      </ul>\\\r\n    </div>\\\r\n    <p>To get started, click anywhere on the map, or type an address, intersection, OPA account number, or DOR Map Registry number into the search box.</p>\\\r\n  ',\r\n}\r\n","export default {\r\n  id: 'threeOneOneCarto',\r\n  type: 'http-get-nearby',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    table: 'public_cases_fc',\r\n    dateMinNum: 1,\r\n    dateMinType: 'year',\r\n    dateField: 'requested_datetime',\r\n    params: {},\r\n    distances: 250,\r\n  }\r\n}\r\n","export default {\r\n  id: 'assessmentHist',\r\n  type: 'http-get',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      q: function(feature){ return \"select * from assessments where parcel_number = '\" + feature.properties.opa_account_num +\"'\"},\r\n    }\r\n  }\r\n}\r\n","module.exports = __webpack_public_path__ + \"index.html\";","export default {\r\n  id: 'dorCondoList',\r\n  type: 'http-get',\r\n  targets: {\r\n    get: function(state) {\r\n      return state.parcels.dor.data;\r\n    },\r\n    getTargetId: function(target) {\r\n      return target.properties.OBJECTID;\r\n    },\r\n  },\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      q: function(feature, state){\r\n        // console.log(state.parcels.dor.data[0].properties, 'mapreg', state.parcels.dor.data[0].properties.MAPREG);\r\n        return \"select * from condominium where mapref = '\" + state.parcels.dor.data[0].properties.MAPREG + \"'\\\r\n                                          and status in (1,3)\"\r\n      },// + \"' or addresskey = '\" + feature.properties.li_address_key.toString() + \"'\",\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'liInspections',\r\n  type: 'http-get',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      q: function(feature){ return \"select * from li_case_inspections where address = '\" + feature.properties.street_address + \"' or addresskey = '\" + feature.properties.li_address_key.toString() + \"'\"},\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'liPermits',\r\n  type: 'http-get',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      q: function(feature){ return \"select * from li_permits where address = '\" + feature.properties.street_address + \"' or addresskey = '\" + feature.properties.li_address_key.toString() + \"'\"},\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'liPermitsAdditional',\r\n  type: 'http-get',\r\n  url: 'http://ase.phila.gov/arcgis/rest/services/GSG/GIS_LNI_LI_PERMITS_PLANNING/FeatureServer/0/query?',\r\n  options: {\r\n    params: {\r\n      where: function(feature) {\r\n        return \"ADDRESS = '\" + feature.properties.street_address + \"' OR ADDRESSKEY = '\" + feature.properties.li_address_key + \"'\"\r\n      },\r\n      outFields: '*',\r\n      f: 'json'\r\n    },\r\n    success: function(data) {\r\n      return data.features;\r\n    },\r\n  },\r\n}\r\n","export default {\r\n  id: 'liViolations',\r\n  type: 'http-get',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      q: function(feature){ return \"select * from li_violations where address = '\" + feature.properties.street_address + \"' or addresskey = '\" + feature.properties.li_address_key.toString() + \"'\"},\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'nearbyZoningAppeals',\r\n  type: 'http-get-nearby',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    table: 'li_appeals',\r\n    dateMinNum: 1,\r\n    dateMinType: 'year',\r\n    dateField: 'decisiondate',\r\n    params: {},\r\n    distances: 250,\r\n  }\r\n}\r\n","export default {\r\n  id: 'opa',\r\n  type: 'http-get',\r\n  url: 'https://data.phila.gov/resource/w7rb-qrn8.json',\r\n  options: {\r\n    params: {\r\n      parcel_number: function(feature) { return feature.properties.opa_account_num; }\r\n    },\r\n    success: function(data) {\r\n      return data[0];\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'rco',\r\n  type: 'esri',\r\n  url: '//services.arcgis.com/fLeGjb7u4uXqeF9q/arcgis/rest/services/Zoning_RCO/FeatureServer/0',\r\n  options: {\r\n    relationship: 'contains',\r\n  },\r\n  // success(data) {\r\n  //   // format phone numbers\r\n  //   console.log('rco success', data);\r\n  //\r\n  //   var s2 = (\"\"+s).replace(/\\D/g, '');\r\n  //   var m = s2.match(/^(\\d{3})(\\d{3})(\\d{4})$/);\r\n  //   return (!m) ? null : \"(\" + m[1] + \") \" + m[2] + \"-\" + m[3];\r\n  //\r\n  //   return data;\r\n  // }\r\n}\r\n","export default {\r\n id: 'streetClosures',\r\n type: 'http-get',\r\n url: '//services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/LaneClosure_Master/FeatureServer/0/query',\r\n options: {\r\n   params: {\r\n     where: function(feature, state) {\r\n       // console.log('seg.js feature:', feature, 'state:', state);\r\n       let where = \"SEG_ID = \" + feature.properties.seg_id\r\n       return where;\r\n     },\r\n     outFields: \"PERMITTYPE, OCCUPANCYTYPE, PERMITNUMBER, EFFECTIVEDATE,\\\r\n                 EXPIRATIONDATE, RAINDATE, PURPOSE, STATUS, SEG_ID, TYPE,\\\r\n                 ADDRESS\",\r\n     returnDistinctValues: 'true',\r\n     returnGeometry: 'false',\r\n     f: 'json'\r\n   },\r\n\r\n   success: function(data) {\r\n     // console.log('seg.js success, data:', data);\r\n     return data.features;\r\n   }\r\n }\r\n}\r\n\r\n\r\n\r\n\r\n// export default {\r\n//   id: 'street-closures',\r\n//   type: 'esri-nearby',\r\n//   url: '//services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/LaneClosure_Master/FeatureServer/0/query',\r\n//   options: {\r\n//     geometryServerUrl: '//gis.phila.gov/arcgis/rest/services/Geometry/GeometryServer/',\r\n//     calculateDistance: true,\r\n//     distances: 1320,\r\n//   },\r\n// }\r\n","export default {\r\n  id: 'stormwater',\r\n  type: 'http-get',\r\n  url: 'https://api.phila.gov/stormwater',\r\n  options: {\r\n    params: {\r\n      search: function(feature){ return feature.properties.street_address; }\r\n    },\r\n    success: function(data) {\r\n      return data[0];\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'vacantBuilding',\r\n  type: 'esri',\r\n  url: 'https://services.arcgis.com/fLeGjb7u4uXqeF9q/arcgis/rest/services/Vacant_Indicators_Bldg/FeatureServer/0',\r\n  options: {\r\n    relationship: 'contains',\r\n  },\r\n  // params: {\r\n  //   query: feature => L.esri.query({url: 'https://services.arcgis.com/fLeGjb7u4uXqeF9q/arcgis/rest/services/Vacant_Indicators_Bldg/FeatureServer/0'}).contains(feature)\r\n  // },\r\n  success: function(data) {\r\n    return data;\r\n  }\r\n}\r\n","export default {\r\n  id: 'vacantIndicatorsPoints',\r\n  type: 'esri-nearby',\r\n  url: 'https://services.arcgis.com/fLeGjb7u4uXqeF9q/arcgis/rest/services/Vacant_Indicators_Points/FeatureServer/0',\r\n  options: {\r\n    geometryServerUrl: 'http://gis.phila.gov/arcgis/rest/services/Geometry/GeometryServer/',\r\n    distances: 800,\r\n    calculateDistance: true,\r\n  },\r\n}\r\n","export default {\r\n  id: 'vacandLand',\r\n  type: 'esri',\r\n  url: 'https://services.arcgis.com/fLeGjb7u4uXqeF9q/arcgis/rest/services/Vacant_Indicators_Land/FeatureServer/0',\r\n  options: {\r\n    relationship: 'contains',\r\n  },\r\n  // params: {\r\n  //   query: feature => L.esri.query({url: 'https://services.arcgis.com/fLeGjb7u4uXqeF9q/arcgis/rest/services/Vacant_Indicators_Land/FeatureServer/0'}).contains(feature)\r\n  // },\r\n  success: function(data) {\r\n    return data;\r\n  }\r\n}\r\n","export default {\r\n  id: 'zoningAppeals',\r\n  type: 'http-get',\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      q: function(feature) {\r\n        var stmt = \"select * from li_appeals where address = '\" + feature.properties.street_address + \"'\";\r\n        var addressKey = feature.properties.li_address_key;\r\n\r\n        if (addressKey && addressKey.length > 0) {\r\n          stmt += \" or addresskey = '\" + feature.properties.li_address_key.toString() + \"'\";\r\n        }\r\n\r\n        return stmt;\r\n      }\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'zoningBase',\r\n  type: 'http-get',\r\n  dependent: 'parcel',\r\n  targets: {\r\n    get: function(state) {\r\n      return state.parcels.dor.data;\r\n    },\r\n    getTargetId: function(target) {\r\n      return target.properties.OBJECTID;\r\n    },\r\n  },\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      q: function(feature, state) {\r\n        // console.log('feature:', feature, 'state.parcels.dor:', state.parcels.dor, 'state.parcels.dor.data[0]', state.parcels.dor.data[0]);\r\n        // var stmt = \"with all_zoning as (select * from zoning_basedistricts),\"\r\n        //          + \"parcel as (select * from dor_parcel where dor_parcel.mapreg = '\" + feature.properties.MAPREG + \"'),\"\r\n        //          // + \"parcel as (select * from dor_parcel where dor_parcel.mapreg = '\" + state.parcels.dor.data[0].properties.MAPREG + \"'),\"\r\n        //          + \"zp as (select all_zoning.* from all_zoning, parcel where st_intersects(parcel.the_geom, all_zoning.the_geom)),\"\r\n        //          // + \"select zp.source_object_id, zp.value, st_area(st_intersection(zp.the_geom, parcel.the_geom)) / st_area(parcel.the_geom) as geom from zp, parcel\";\r\n        //          + \"total as (select zp.objectid, zp.long_code, st_area(st_intersection(zp.the_geom, parcel.the_geom)) / st_area(parcel.the_geom) as overlap_area from zp, parcel)\"\r\n        //          + \"select * from total where overlap_area >= 0.01\"\r\n        //          // + \"select * from zp\";\r\n        var mapreg = feature.properties.MAPREG,\r\n            stmt = \"\\\r\n              WITH all_zoning AS \\\r\n                ( \\\r\n                  SELECT * \\\r\n                  FROM   phl.zoning_basedistricts \\\r\n                ), \\\r\n              parcel AS \\\r\n                ( \\\r\n                  SELECT * \\\r\n                  FROM   phl.dor_parcel \\\r\n                  WHERE  dor_parcel.mapreg = '\" + mapreg + \"' \\\r\n                ), \\\r\n              zp AS \\\r\n                ( \\\r\n                  SELECT all_zoning.* \\\r\n                  FROM   all_zoning, parcel \\\r\n                  WHERE  St_intersects(parcel.the_geom, all_zoning.the_geom) \\\r\n                ), \\\r\n              combine AS \\\r\n                ( \\\r\n                  SELECT zp.objectid, \\\r\n                  zp.long_code, \\\r\n                  zp.pending, \\\r\n                  zp.pendingbill, \\\r\n                  zp.pendingbillurl, \\\r\n                  St_area(St_intersection(zp.the_geom, parcel.the_geom)) / St_area(parcel.the_geom) AS overlap_area \\\r\n                  FROM zp, parcel \\\r\n                ), \\\r\n              total AS \\\r\n                ( \\\r\n                  SELECT long_code, pending, pendingbill, pendingbillurl, sum(overlap_area) as sum_overlap_area \\\r\n                  FROM combine \\\r\n                  GROUP BY long_code, pending, pendingbill, pendingbillurl \\\r\n                ) \\\r\n              SELECT * \\\r\n              FROM total \\\r\n              WHERE sum_overlap_area >= 0.01 \\\r\n            \";\r\n        return stmt;\r\n      }\r\n    }\r\n  }\r\n}\r\n","export default {\r\n  id: 'zoningOverlay',\r\n  type: 'http-get',\r\n  dependent: 'parcel',\r\n  targets: {\r\n    get: function(state) {\r\n      return state.parcels.dor.data;\r\n    },\r\n    getTargetId: function(target) {\r\n      return target.properties.OBJECTID;\r\n    },\r\n  },\r\n  url: 'https://phl.carto.com/api/v2/sql',\r\n  options: {\r\n    params: {\r\n      q: function(feature, state) {\r\n        // var stmt = \"with all_zoning as (select * from zoning_overlays),\"\r\n        //          + \"parcel as (select * from dor_parcel where dor_parcel.mapreg = '\" + feature.properties.dor_parcel_id + \"'),\"\r\n        //          // + \"parcel as (select * from dor_parcel where dor_parcel.mapreg = '\" + feature.properties.MAPREG + \"'),\"\r\n        //          // + \"parcel as (select * from dor_parcel where dor_parcel.mapreg = '\" + state.parcels.dor.data[0].properties.MAPREG + \"'),\"\r\n        //          + \"zp as (select all_zoning.* from all_zoning, parcel where st_intersects(parcel.the_geom, all_zoning.the_geom)),\"\r\n        //          + \"total as (select zp.*, st_area(st_intersection(zp.the_geom, parcel.the_geom)) / st_area(parcel.the_geom) as overlap_area from zp, parcel)\"\r\n        //          + \"select * from total where overlap_area >= 0.01\"\r\n        var mapreg = feature.properties.MAPREG,\r\n            stmt = \"\\\r\n            WITH all_zoning AS \\\r\n              ( \\\r\n                SELECT * \\\r\n                FROM   phl.zoning_overlays \\\r\n              ), \\\r\n            parcel AS \\\r\n              ( \\\r\n                SELECT * \\\r\n                FROM   phl.dor_parcel \\\r\n                WHERE  dor_parcel.mapreg = '\" + mapreg + \"' \\\r\n              ), \\\r\n            zp AS \\\r\n              ( \\\r\n                SELECT all_zoning.* \\\r\n                FROM all_zoning, parcel \\\r\n                WHERE st_intersects(parcel.the_geom, all_zoning.the_geom) \\\r\n              ), \\\r\n            total AS \\\r\n              ( \\\r\n                SELECT zp.*, st_area(St_intersection(zp.the_geom, parcel.the_geom)) / st_area(parcel.the_geom) AS overlap_area \\\r\n                FROM   zp, parcel \\\r\n              ) \\\r\n            SELECT cartodb_id, \\\r\n                  code_section, \\\r\n                  code_section_link, \\\r\n                  objectid, \\\r\n                  overlap_area, \\\r\n                  overlay_name, \\\r\n                  overlay_symbol, \\\r\n                  pending, \\\r\n                  pendingbill, \\\r\n                  pendingbillurl, \\\r\n                  sunset_date, \\\r\n                  type \\\r\n            FROM total \\\r\n            WHERE overlap_area >= 0.01 \\\r\n          \";\r\n        return stmt;\r\n      }\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":""}